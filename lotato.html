<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LOTATO</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="manifest" href="/manifest.json">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        :root {
            --primary-color: #ad00f1;
            --secondary-color: #3498db;
            --accent-color: #05790d;
            --success-color: #f08c00;
            --warning-color: #1cf100;
            --light-color: #ecf0f1;
            --dark-color: #0004ff;
            --miami-color: #e74c3c;
            --georgia-color: #031a8e;
            --newyork-color: #e99700;
            --texas-color: #5d0b2a;
            --tunisia-color: #1abc9c;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: var(--dark-color);
            line-height: 1.6;
            max-width: 500px;
            margin: 0 auto;
            position: relative;
            min-height: 100vh;
        }
        
        .container {
            padding: 15px;
            padding-bottom: 80px;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary-color), #1a2530);
            color: white;
            padding: 15px;
            text-align: center;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            position: relative;
        }
        
        .header-content {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo-image {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--warning-color);
        }
        
        .logo {
            font-size: 2.5rem;
            color: var(--warning-color);
        }
        
        .header-text h1 {
            font-size: 1.8rem;
            margin-bottom: 5px;
        }
        
        .header-text p {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .time-display {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 8px 15px;
            border-radius: 20px;
            margin-top: 10px;
            font-size: 0.9rem;
        }
        
        .draws-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .draw-card {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 15px;
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
        }
        
        .draw-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        
        .draw-card.miami {
            border-top: 5px solid var(--miami-color);
        }
        
        .draw-card.georgia {
            border-top: 5px solid var(--georgia-color);
        }
        
        .draw-card.newyork {
            border-top: 5px solid var(--newyork-color);
        }
        
        .draw-card.texas {
            border-top: 5px solid var(--texas-color);
        }
        
        .draw-card.tunisia {
            border-top: 5px solid var(--tunisia-color);
        }
        
        .draw-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .miami .draw-icon {
            color: var(--miami-color);
        }
        
        .georgia .draw-icon {
            color: var(--georgia-color);
        }
        
        .newyork .draw-icon {
            color: var(--newyork-color);
        }
        
        .texas .draw-icon {
            color: var(--texas-color);
        }
        
        .tunisia .draw-icon {
            color: var(--tunisia-color);
        }
        
        .draw-card h3 {
            font-size: 1.2rem;
            margin-bottom: 5px;
        }
        
        .draw-buttons {
            display: flex;
            gap: 5px;
            margin-top: 10px;
        }
        
        .draw-btn {
            flex: 1;
            padding: 6px;
            border: none;
            border-radius: 6px;
            font-size: 0.8rem;
            cursor: pointer;
            background-color: var(--light-color);
            transition: background-color 0.3s;
        }
        
        .draw-btn:hover {
            background-color: #dde4e6;
        }
        
        .draw-btn.active {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .draw-btn.morning {
            background-color: #f39c12;
            color: white;
        }
        
        .draw-btn.evening {
            background-color: #2c3e50;
            color: white;
        }
        
        .results-section {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .section-title {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--light-color);
        }
        
        .section-title i {
            margin-right: 10px;
            color: var(--secondary-color);
        }
        
        .section-title h2 {
            font-size: 1.2rem;
            color: var(--primary-color);
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }
        
        .result-card {
            background-color: var(--light-color);
            padding: 12px;
            border-radius: 8px;
            text-align: center;
        }
        
        .result-card h4 {
            font-size: 0.9rem;
            margin-bottom: 5px;
            color: var(--primary-color);
        }
        
        .result-number {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent-color);
        }
        
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: white;
            display: flex;
            justify-content: space-around;
            padding: 15px;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            max-width: 500px;
            margin: 0 auto;
            z-index: 1000;
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: #7f8c8d;
            font-size: 0.8rem;
            cursor: pointer;
        }
        
        .nav-item.active {
            color: var(--secondary-color);
        }
        
        .nav-icon {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }
        
        /* NOUVEAU: Panneau multi-tirages */
        .multi-draw-panel {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .multi-draw-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .multi-draw-title {
            font-size: 1.2rem;
            color: var(--primary-color);
        }
        
        .multi-draw-toggle {
            background: none;
            border: none;
            color: var(--secondary-color);
            font-size: 1.2rem;
            cursor: pointer;
        }
        
        .multi-draw-content {
            display: none;
        }
        
        .multi-draw-content.expanded {
            display: block;
        }
        
        .multi-draw-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .multi-draw-option {
            background-color: var(--light-color);
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .multi-draw-option:hover {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .multi-draw-option.selected {
            background-color: var(--success-color);
            color: white;
        }
        
        .multi-draw-form {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        
        /* Styles pour les écrans de paris */
        .betting-screen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: white;
            z-index: 100;
            padding: 20px;
            overflow-y: auto;
            max-width: 500px;
            margin: 0 auto;
        }
        
        .betting-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--light-color);
        }
        
        .back-button {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--primary-color);
            margin-right: 15px;
            cursor: pointer;
        }
        
        .betting-title {
            font-size: 1.5rem;
            color: var(--primary-color);
        }
        
        .bet-types-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .bet-type-card {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 15px;
            text-align: center;
            transition: transform 0.3s;
            cursor: pointer;
        }
        
        .bet-type-card:hover {
            transform: scale(1.05);
        }
        
        .bet-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--secondary-color);
        }
        
        .bet-type-card h3 {
            font-size: 1rem;
            margin-bottom: 5px;
        }
        
        .bet-multiplier {
            font-size: 0.9rem;
            color: var(--success-color);
            font-weight: bold;
        }
        
        .bet-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .bet-option {
            background-color: var(--light-color);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .bet-option:hover {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .bet-option-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .bet-option h3 {
            font-size: 1.2rem;
        }
        
        .bet-form {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
        }
        
        .number-inputs {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .number-inputs input {
            text-align: center;
            font-size: 1.2rem;
        }
        
        .bet-actions {
            display: flex;
            gap: 10px;
        }
        
        button {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .btn-primary {
            background-color: var(--secondary-color);
            color: white;
            flex: 2;
        }
        
        .btn-primary:hover {
            background-color: #2980b9;
        }
        
        .btn-secondary {
            background-color: var(--light-color);
            color: var(--dark-color);
            flex: 1;
        }
        
        .btn-secondary:hover {
            background-color: #dde4e6;
        }
        
        .active-bets {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .bet-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid var(--light-color);
        }
        
        .bet-item:last-child {
            border-bottom: none;
        }
        
        .bet-details {
            flex: 2;
        }
        
        .bet-amount {
            flex: 1;
            text-align: right;
            font-weight: bold;
        }
        
        .bet-remove {
            color: var(--accent-color);
            margin-left: 10px;
            cursor: pointer;
        }
        
        .bet-total {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 2px solid var(--light-color);
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .submit-bet {
            background-color: var(--success-color);
            color: white;
            width: 100%;
            padding: 15px;
            margin-top: 20px;
            font-size: 1.1rem;
        }
        
        .submit-bet:hover {
            background-color: #219955;
        }
        
        /* Styles pour les options Lotto 5 */
        .lotto-options {
            margin-bottom: 15px;
        }
        
        .option-group {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .option-label {
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
        }
        
        /* Styles pour les boules terminant par N */
        .n-balls-container {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .n-ball {
            background-color: var(--light-color);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .n-ball:hover {
            background-color: var(--secondary-color);
            color: white;
        }
        
        /* Styles pour l'interface optimisée */
        .quick-bet-form {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .quick-number-input {
            flex: 2;
        }
        
        .quick-amount-input {
            flex: 1;
        }
        
        /* Styles pour les autres écrans */
        .screen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: white;
            z-index: 100;
            padding: 20px;
            overflow-y: auto;
            max-width: 500px;
            margin: 0 auto;
        }
        
        .screen-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--light-color);
        }
        
        .screen-title {
            font-size: 1.5rem;
            color: var(--primary-color);
        }
        
        /* Animation pour l'affichage des écrans */
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        
        .slide-in {
            animation: slideIn 0.3s forwards;
        }
        
        @keyframes slideOut {
            from { transform: translateX(0); }
            to { transform: translateX(100%); }
        }
        
        .slide-out {
            animation: slideOut 0.3s forwards;
        }
        
        /* Styles pour l'impression */
        @media print {
            body * {
                visibility: hidden;
            }
            .print-ticket, .print-ticket * {
                visibility: visible;
            }
            .print-ticket {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
            
            .ticket-logo {
                max-width: 80px;
                height: auto;
            }
        }
        
        /* Styles pour la configuration */
        .config-section {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .config-status {
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            text-align: center;
            font-weight: bold;
        }
        
        .status-connected {
            background-color: #d4edda;
            color: #155724;
        }
        
        .status-disconnected {
            background-color: #f8d7da;
            color: #e400b2;
        }
        
        .draw-info {
            background-color: var(--light-color);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        
        .draw-info h4 {
            margin-bottom: 10px;
            color: var(--primary-color);
        }
        
        .draw-info p {
            margin-bottom: 5px;
        }

        /* Nouveaux styles pour les boutons BO */
        .bo-ball {
            background-color: var(--warning-color);
            color: white;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: background-color 0.3s;
            font-weight: bold;
        }
        
        .bo-ball:hover {
            background-color: #e67e22;
        }

        /* Styles pour les options multiples */
        .multi-option {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 6px;
            cursor: pointer;
        }
        
        .multi-option:hover {
            background-color: #f5f5f5;
        }
        
        .multi-option.selected {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .multi-option input {
            width: auto;
        }
        
        /* Nouveaux styles pour les boutons d'impression */
        .ticket-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .ticket-action-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .save-ticket {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .save-ticket:hover {
            background-color: #2300a0;
        }
        
        .print-ticket-btn {
            background-color: var(--success-color);
            color: white;
        }
        
        .print-ticket-btn:hover {
            background-color: #219955;
        }
        
        /* Styles pour l'historique */
        .history-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .stat-card {
            background-color: var(--light-color);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #7f8c8d;
        }
        
        .history-item {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            padding: 15px;
            margin-bottom: 10px;
            position: relative;
        }
        
        .history-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid var(--light-color);
        }
        
        .history-draw {
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .history-date {
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        .history-bets {
            margin-bottom: 10px;
        }
        
        .history-bet {
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
            font-size: 0.9rem;
        }
        
        .history-total {
            display: flex;
            justify-content: space-between;
            padding-top: 10px;
            border-top: 1px solid var(--light-color);
            font-weight: bold;
        }
        
        /* Nouveaux styles pour les boutons enregistrer et imprimer */
        .ticket-footer {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid var(--light-color);
        }
        
        .ticket-footer-btn {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .search-history {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .search-input {
            flex: 2;
        }
        
        .search-btn {
            flex: 1;
            background-color: var(--secondary-color);
            color: white;
        }
        
        .search-btn:hover {
            background-color: #2980b9;
        }
        
        /* Styles pour les rapports */
        .reports-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .report-btn {
            background-color: var(--light-color);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: background-color 0.3s;
            border: none;
            font-weight: bold;
        }
        
        .report-btn:hover {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .report-btn.general {
            grid-column: 1 / -1;
            background-color: var(--warning-color);
            color: white;
        }
        
        .report-btn.general:hover {
            background-color: #e67e22;
        }
        
        .report-results {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            padding: 15px;
            margin-top: 15px;
        }
        
        .report-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid var(--light-color);
        }
        
        .report-item:last-child {
            border-bottom: none;
        }

        /* Nouveau style pour le bouton enregistrer et imprimer */
        .save-print-btn {
            background-color: var(--warning-color);
            color: white;
        }
        
        .save-print-btn:hover {
            background-color: #e67e22;
        }

        /* Styles pour l'écran de connexion */
        .login-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, var(--primary-color), #1a2530);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            padding: 20px;
        }
        
        .login-container {
            background-color: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            width: 100%;
            max-width: 400px;
        }
        
        .login-logo {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .login-logo .logo {
            font-size: 3rem;
            color: var(--warning-color);
        }
        
        .login-title {
            text-align: center;
            margin-bottom: 20px;
            color: var(--primary-color);
        }
        
        .login-error {
            background-color: #f8d7da;
            color: #721c24;
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 15px;
            text-align: center;
            display: none;
        }
        
        /* Nouveaux styles pour l'affichage des paris groupés */
        .bets-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
        }
        
        .bets-table th {
            background-color: var(--light-color);
            padding: 10px;
            text-align: left;
            font-weight: bold;
            border-bottom: 2px solid #ddd;
        }
        
        .bets-table td {
            padding: 8px 10px;
            border-bottom: 1px solid #eee;
        }
        
        .bets-table tr:hover {
            background-color: #f9f9f9;
        }
        
        .grouped-bets {
            background-color: #f8f9fa;
            border-left: 4px solid var(--secondary-color);
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        
        .group-header {
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .group-items {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 5px;
            margin-top: 5px;
        }
        
        .group-item {
            background-color: white;
            padding: 5px;
            border-radius: 4px;
            text-align: center;
            border: 1px solid #ddd;
            font-size: 0.9rem;
        }
        
        .bet-summary {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        
        .bet-summary:last-child {
            border-bottom: none;
        }
        
        .bet-type {
            font-weight: bold;
            min-width: 100px;
        }
        
        .bet-numbers {
            flex: 1;
            text-align: center;
        }
        
        .bet-amount-summary {
            min-width: 80px;
            text-align: right;
            font-weight: bold;
        }
        
        /* Styles pour la synchronisation Firebase */
        .sync-status {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 1000;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .sync-connected {
            background-color: var(--success-color);
            color: white;
        }
        
        .sync-disconnected {
            background-color: var(--accent-color);
            color: white;
        }
        
        .sync-pending {
            background-color: var(--warning-color);
            color: white;
        }
        
        /* Nouveaux styles pour les notifications */
        .notification {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--primary-color);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 10px;
            max-width: 90%;
            animation: slideUp 0.3s ease-out;
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translate(-50%, 20px);
            }
            to {
                opacity: 1;
                transform: translate(-50%, 0);
            }
        }
        
        .notification.success {
            background-color: var(--success-color);
        }
        
        .notification.warning {
            background-color: var(--warning-color);
        }
        
        .notification.error {
            background-color: var(--accent-color);
        }
        
        .notification i {
            font-size: 1.2rem;
        }
        
        /* Styles pour le logo dans le ticket */
        .ticket-logo-container {
            text-align: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--light-color);
        }
        
        .ticket-logo {
            max-width: 100px;
            height: auto;
            border-radius: 10px;
        }
        
        /* Style pour le bouton de vérification des fiches */
        .sync-check-btn {
            background-color: var(--warning-color);
            color: white;
        }
        
        .sync-check-btn:hover {
            background-color: #e67e22;
        }
        
        /* Indicateur de fiches en attente */
        .pending-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--accent-color);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        /* Améliorations pour la navigation après ajout */
        .bet-type-navigation {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding-bottom: 10px;
        }
        
        .bet-type-nav-item {
            background-color: var(--light-color);
            padding: 10px 15px;
            border-radius: 20px;
            white-space: nowrap;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .bet-type-nav-item:hover {
            background-color: #dde4e6;
        }
        
        .bet-type-nav-item.active {
            background-color: var(--secondary-color);
            color: white;
            border-color: var(--secondary-color);
        }
        
        /* Styles pour les boutons de modification */
        .edit-btn {
            background-color: var(--warning-color);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            cursor: pointer;
            margin-left: 5px;
        }
        
        .edit-btn:hover {
            background-color: #e67e22;
        }
        
        .delete-btn {
            background-color: var(--accent-color);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            cursor: pointer;
            margin-left: 5px;
        }
        
        .delete-btn:hover {
            background-color: #c0392b;
        }
        
        /* Styles pour les boutons automatiques */
        .auto-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .auto-btn {
            flex: 1;
            background-color: var(--secondary-color);
            color: white;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        
        .auto-btn:hover {
            background-color: #2980b9;
        }
        
        .auto-btn.reverse {
            background-color: var(--tunisia-color);
        }
        
        .auto-btn.reverse:hover {
            background-color: #16a085;
        }
        
        /* Styles pour les boules paire (GRAP corrigé) */
        .pair-ball {
            background-color: var(--light-color);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }
        
        .pair-ball:hover {
            background-color: var(--secondary-color);
            color: white;
        }
        
        /* Styles pour l'écran de rapport */
        .report-screen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: white;
            z-index: 100;
            padding: 20px;
            overflow-y: auto;
            max-width: 500px;
            margin: 0 auto;
        }
        
        .report-container {
            padding: 15px;
        }
        
        .report-header {
            text-align: center;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
        }
        
        .report-details {
            margin-bottom: 20px;
        }
        
        .report-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        
        .report-row.total {
            font-weight: bold;
            border-top: 2px solid #333;
            border-bottom: none;
            padding-top: 15px;
            margin-top: 10px;
        }
        
        .report-profit {
            color: var(--success-color);
            font-weight: bold;
        }
        
        .report-loss {
            color: var(--accent-color);
            font-weight: bold;
        }
        
        /* Nouveaux styles pour la sélection multiple de graps */
        .all-graps-btn {
            background-color: var(--warning-color);
            color: white;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .all-graps-btn:hover {
            background-color: #e67e22;
        }
        
        /* Styles pour la sélection des jeux multi-tirages */
        .multi-game-select {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .multi-game-option {
            background-color: var(--light-color);
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .multi-game-option:hover {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .multi-game-option.selected {
            background-color: var(--success-color);
            color: white;
        }
        
        /* Styles pour la gestion des fiches */
        .ticket-management {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            padding: 15px;
            margin-bottom: 10px;
        }
        
        .ticket-management-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .ticket-actions-buttons {
            display: flex;
            gap: 10px;
        }
        
        .ticket-search-box {
            margin-bottom: 15px;
        }
        
        .ticket-details {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 6px;
            margin-top: 10px;
        }
        
        /* Organisation améliorée des jeux */
        .game-category {
            margin-bottom: 20px;
        }
        
        .game-category-title {
            font-size: 1.1rem;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 2px solid var(--light-color);
        }
        
        .game-category-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        
        .game-item {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border-left: 4px solid var(--secondary-color);
        }
        
        .game-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        .game-item.borlette {
            border-left-color: var(--miami-color);
        }
        
        .game-item.lotto {
            border-left-color: var(--newyork-color);
        }
        
        .game-item.special {
            border-left-color: var(--success-color);
        }
        
        .game-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .game-multiplier {
            font-size: 0.9rem;
            color: var(--warning-color);
            font-weight: bold;
        }
        
        /* NOUVEAU: Styles pour l'affichage simultané de toutes les catégories */
        .all-categories-container {
            display: block;
        }
        
        .game-category {
            display: block !important;
        }
        
        /* Nouveaux styles pour l'écran de vérification des résultats */
        .results-check-screen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: white;
            z-index: 100;
            padding: 20px;
            overflow-y: auto;
            max-width: 500px;
            margin: 0 auto;
        }
        
        .winning-ticket {
            background-color: #d4edda;
            border-left: 4px solid var(--success-color);
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
        }
        
        .winning-amount {
            color: var(--success-color);
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .lot-result {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 5px;
        }
        
        .lot-number {
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .lot-multiplier {
            color: var(--warning-color);
            font-weight: bold;
        }
        
        .check-results-btn {
            background-color: var(--success-color);
            color: white;
            padding: 12px;
            border-radius: 8px;
            border: none;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
        }
        
        .check-results-btn:hover {
            background-color: #219955;
        }
        
        /* NOUVEAU: Styles pour les fiches multi-tirages */
        .multi-draw-ticket {
            background-color: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .multi-draw-ticket-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #ffc107;
        }
        
        .multi-draw-bets-list {
            max-height: 200px;
            overflow-y: auto;
            margin-bottom: 10px;
        }
        
        .multi-draw-bet-item {
            display: flex;
            justify-content: space-between;
            padding: 8px;
            border-bottom: 1px solid #eee;
        }
        
        .multi-draw-bet-item:last-child {
            border-bottom: none;
        }
        
        /* NOUVEAU: Notification pour le total */
        .total-notification {
            position: fixed;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--primary-color);
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 999;
            display: flex;
            align-items: center;
            gap: 10px;
            max-width: 90%;
            animation: slideDown 0.3s ease-out;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translate(-50%, -20px);
            }
            to {
                opacity: 1;
                transform: translate(-50%, 0);
            }
        }
        
        .total-notification .total-amount {
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        /* NOUVEAU: Boutons pour multi-tirages */
        .multi-draw-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .multi-draw-action-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .add-to-multi-draw {
            background-color: var(--secondary-color);
            color: white;
        }
        
        .add-to-multi-draw:hover {
            background-color: #2980b9;
        }
        
        .view-multi-draw-ticket {
            background-color: var(--warning-color);
            color: white;
        }
        
        .view-multi-draw-ticket:hover {
            background-color: #e67e22;
        }
        
        /* NOUVEAU: Écran pour visualiser les fiches multi-tirages */
        .multi-tickets-screen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: white;
            z-index: 100;
            padding: 20px;
            overflow-y: auto;
            max-width: 500px;
            margin: 0 auto;
        }
        
        .multi-ticket-item {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid var(--warning-color);
        }
        
        /* Styles pour les nouveaux formulaires */
        .options-container {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        
        .option-checkbox {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            padding: 8px;
            background-color: white;
            border-radius: 6px;
            cursor: pointer;
        }
        
        .option-checkbox:hover {
            background-color: #e9ecef;
        }
        
        .option-checkbox input {
            width: auto;
            margin-right: 5px;
        }
        
        .option-checkbox .option-multiplier {
            margin-left: auto;
            font-weight: bold;
            color: var(--success-color);
        }
        
        .manual-balls-input {
            margin-bottom: 15px;
        }
        
        .manual-balls-input input {
            font-family: monospace;
        }
        
        .balls-list {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 10px;
        }
        
        .ball-tag {
            background-color: var(--light-color);
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .ball-tag .remove-ball {
            color: var(--accent-color);
            cursor: pointer;
            font-size: 0.8rem;
        }
    </style>
</head>
<body>
    <!-- Écran de connexion -->
    <div class="login-screen" id="login-screen">
        <div class="login-container">
            <div class="login-logo">
                <div class="logo">
                    <i class="fas fa-dice"></i>
                </div>
            </div>
            <h2 class="login-title">LOTATO</h2>
            <div class="login-error" id="login-error">
                Identifiant ou mot de passe incorrect
            </div>
            <div class="form-group">
                <label for="admin-username">Identifiant</label>
                <input type="text" id="admin-username" placeholder="admin">
            </div>
            <div class="form-group">
                <label for="admin-password">Mot de passe</label>
                <input type="password" id="admin-password" placeholder="••••••••">
            </div>
            <button class="submit-bet" id="login-btn">Konekte</button>
        </div>
    </div>
    
    <!-- Vérification de connexion -->
    <div class="connection-check" id="connection-check" style="display: none;">
        <div class="connection-content">
            <h3>Verifikasyon Koneksyon</h3>
            <div class="connection-status">
                <div class="status-indicator disconnected" id="internet-status"></div>
                <span id="internet-text">Entènèt: Pa konekte</span>
            </div>
            <div class="connection-status">
                <div class="status-indicator disconnected" id="server-status"></div>
                <span id="server-text">Sèvè: Pa konekte</span>
            </div>
            <div class="connection-status">
                <div class="status-indicator disconnected" id="supabase-status"></div>
                <span id="supabase-text">Baz de done: Pa konekte</span>
            </div>
            <p id="connection-message">Tanpri tann pandan y ap verifye koneksyon yo...</p>
            <div class="bet-actions" style="margin-top: 20px;">
                <button class="btn-primary" id="retry-connection">Eseye ankò</button>
                <button class="btn-secondary" id="cancel-print">Anile</button>
            </div>
        </div>
    </div>
    
    <!-- Écran de rapport -->
    <div class="report-screen" id="report-screen">
        <div class="screen-header">
            <button class="back-button" id="back-from-report">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h2 class="screen-title">Rapò Fin Tiraj</h2>
        </div>
        <div class="report-container" id="report-content">
            <!-- Le rapport sera généré ici -->
        </div>
    </div>
    
    <!-- NOUVEAU: Écran de vérification des résultats -->
    <div class="results-check-screen" id="results-check-screen">
        <div class="screen-header">
            <button class="back-button" id="back-from-results">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h2 class="screen-title">Verifye fich ki genyen </h2>
        </div>
        
        <div style="margin-bottom: 20px;">
            <div class="draw-info">
                <h4>Rezilta Dènye Tiraj</h4>
                <div id="latest-results">
                    <!-- Les résultats seront chargés ici -->
                </div>
            </div>
            
            <button class="check-results-btn" id="check-winners-btn">
                <i class="fas fa-trophy"></i> Fich ki Genyen
            </button>
            
            <div style="margin-top: 20px;" id="winning-summary">
                <!-- Résumé des gains -->
            </div>
        </div>
        
        <div id="winning-tickets-container">
            <!-- Les fiches gagnantes seront affichées ici -->
        </div>
    </div>
    
    <!-- NOUVEAU: Écran pour visualiser les fiches multi-tirages -->
    <div class="multi-tickets-screen" id="multi-tickets-screen">
        <div class="screen-header">
            <button class="back-button" id="back-from-multi-tickets">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h2 class="screen-title">Fiche Multi-Tirages</h2>
        </div>
        
        <div id="multi-tickets-list">
            <!-- Les fiches multi-tirages seront affichées ici -->
        </div>
    </div>
    
    <!-- Indicateur de synchronisation -->
    <div class="sync-status sync-disconnected" id="sync-status" style="display: none;">
        <i class="fas fa-cloud"></i> <span id="sync-text">Pa Konekte</span>
    </div>
    
    <!-- Panneau d'administration flottant -->
    <div class="admin-panel" id="admin-panel" style="display: none;">
        <div class="admin-btn" id="admin-menu-btn">
            <i class="fas fa-cog"></i>
        </div>
    </div>
    
    <div class="container" id="main-container" style="display: none;">
        <header>
            <div class="header-content">
                <div class="logo-container">
                    <img src="logo-borlette.jpg" alt="Logo Nova Lotto" class="logo-image" id="company-logo">
                    <div class="logo">
                        <i class="fas fa-dice"></i>
                    </div>
                </div>
                <div class="header-text">
                    <h1>Lotato</h1>
                    <p>Chwazi yon Jwet</p>
                </div>
            </div>
            <div class="time-display">
                <i class="fas fa-clock"></i> <span id="current-time">Samdi, 29 Nov - 10:45 AM</span>
            </div>
            <!-- NOUVEAU: Bouton pour vérifier les résultats -->
            <div style="margin-top: 10px;">
                <button class="check-results-btn" id="open-results-check">
                    <i class="fas fa-search"></i> Tcheke Rezilta ak Fich ki genyen 
                </button>
            </div>
            <!-- NOUVEAU: Bouton pour voir les fiches multi-tirages -->
            <div style="margin-top: 10px;">
                <button class="check-results-btn" id="open-multi-tickets">
                    <i class="fas fa-ticket-alt"></i> Wè fich plizyè tiraj
                </button>
            </div>
        </header>
        
        <!-- Panneau Multi-Tirages amélioré -->
        <div class="multi-draw-panel">
            <div class="multi-draw-header">
                <h3 class="multi-draw-title">Jwe nan Plizyè Tiraj</h3>
                <button class="multi-draw-toggle" id="multi-draw-toggle">
                    <i class="fas fa-chevron-down"></i>
                </button>
            </div>
            <div class="multi-draw-content" id="multi-draw-content">
                <div class="multi-draw-grid" id="multi-draw-options">
                    <!-- Les options seront ajoutées dynamiquement -->
                </div>
                
                <!-- Sélection des jeux -->
                <div class="multi-game-select" id="multi-game-select">
                    <!-- Les jeux seront ajoutés dynamiquement -->
                </div>
                
                <div class="multi-draw-form">
                    <div class="form-group" id="multi-number-inputs">
                        <!-- Les champs de nombre seront ajoutés dynamiquement -->
                    </div>
                    <div class="form-group">
                        <label for="multi-draw-amount">Kantite pa tiraj</label>
                        <input type="number" id="multi-draw-amount" placeholder="Kantite" min="1" value="1">
                    </div>
                    
                    <!-- NOUVEAU: Actions pour multi-tirages -->
                    <div class="multi-draw-actions">
                        <button class="multi-draw-action-btn add-to-multi-draw" id="add-to-multi-draw">
                            <i class="fas fa-plus"></i> Ajoute nan Fiche Multi-Tirages
                        </button>
                        <button class="multi-draw-action-btn view-multi-draw-ticket" id="view-current-multi-ticket">
                            <i class="fas fa-eye"></i> Wè Fich konnya a
                        </button>
                    </div>
                </div>
                
                <!-- NOUVEAU: Affichage du total actuel pour multi-tirages -->
                <div id="current-multi-ticket-info" style="display: none; margin-top: 15px; padding: 10px; background-color: #f8f9fa; border-radius: 8px;">
                    <h4>Fiche Multi-Tirages Aktuèl</h4>
                    <div id="multi-ticket-summary">
                        <!-- Résumé du ticket actuel -->
                    </div>
                    <div class="multi-draw-actions" style="margin-top: 10px;">
                        <button class="ticket-action-btn save-print-btn" id="save-print-multi-ticket">
                            <i class="fas fa-save"></i> <i class="fas fa-print"></i> Anrejistre & Enprime Fiche
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="draws-container">
            <div class="draw-card miami" data-draw="miami">
                <div class="draw-icon">
                    <i class="fas fa-sun"></i>
                </div>
                <h3>Miami</h3>
                <div class="draw-buttons">
                    <button class="draw-btn morning active" data-time="morning">1:30 PM</button>
                    <button class="draw-btn evening" data-time="evening">9:50 PM</button>
                </div>
                <div class="draw-countdown">18 h 30 min</div>
            </div>
            
            <div class="draw-card georgia" data-draw="georgia">
                <div class="draw-icon">
                    <i class="fas fa-map-marker-alt"></i>
                </div>
                <h3>Georgia</h3>
                <div class="draw-buttons">
                    <button class="draw-btn morning active" data-time="morning">12:30 PM</button>
                    <button class="draw-btn evening" data-time="evening">7:00 PM</button>
                </div>
                <div class="draw-countdown">17 h 29 min</div>
            </div>
            
            <div class="draw-card newyork" data-draw="newyork">
                <div class="draw-icon">
                    <i class="fas fa-building"></i>
                </div>
                <h3>New York</h3>
                <div class="draw-buttons">
                    <button class="draw-btn morning active" data-time="morning">2:30 PM</button>
                    <button class="draw-btn evening" data-time="evening">8:00 PM</button>
                </div>
                <div class="draw-countdown">19 h 30 min</div>
            </div>
            
            <div class="draw-card texas" data-draw="texas">
                <div class="draw-icon">
                    <i class="fas fa-hat-cowboy"></i>
                </div>
                <h3>Texas</h3>
                <div class="draw-buttons">
                    <button class="draw-btn morning active" data-time="morning">12:00 PM</button>
                    <button class="draw-btn evening" data-time="evening">6:00 PM</button>
                </div>
                <div class="draw-countdown">18 h 27 min</div>
            </div>
            
            <!-- NOUVEAU: Borlette Tunisie -->
            <div class="draw-card tunisia" data-draw="tunisia">
                <div class="draw-icon">
                    <i class="fas fa-flag"></i>
                </div>
                <h3>Tunisie</h3>
                <div class="draw-buttons">
                    <button class="draw-btn morning active" data-time="morning">10:30 AM</button>
                    <button class="draw-btn evening" data-time="evening">2:00 PM</button>
                </div>
                <div class="draw-countdown">8 h 30 min</div>
            </div>
        </div>
        
        <div class="results-section">
            <div class="section-title">
                <i class="fas fa-trophy"></i>
                <h2>Dènye Rezilta</h2>
            </div>
            
            <div class="results-grid">
                <div class="result-card">
                    <h4>Miami</h4>
                    <div class="result-number">451</div>
                </div>
                <div class="result-card">
                    <h4>Georgia</h4>
                    <div class="result-number">327</div>
                </div>
                <div class="result-card">
                    <h4>New York</h4>
                    <div class="result-number">892</div>
                </div>
                <div class="result-card">
                    <h4>Texas</h4>
                    <div class="result-number">567</div>
                </div>
                <div class="result-card">
                    <h4>Tunisie</h4>
                    <div class="result-number">234</div>
                </div>
            </div>
            
            <!-- NOUVEAU: Bouton pour générer le rapport -->
            <div class="ticket-actions" style="margin-top: 15px;">
                <button class="ticket-action-btn save-print-btn" id="generate-report-btn">
                    <i class="fas fa-file-alt"></i> Jenere Rapò Fin Tiraj
                </button>
            </div>
        </div>
    </div>
    
    <div class="bottom-nav" id="bottom-nav" style="display: none;">
        <div class="nav-item active" data-screen="home">
            <div class="nav-icon">
                <i class="fas fa-home"></i>
            </div>
            <span>Akèy</span>
        </div>
        <div class="nav-item" data-screen="winning-tickets">
            <div class="nav-icon">
                <i class="fas fa-trophy"></i>
            </div>
            <span>Fich ki Genyen </span>
        </div>
        <div class="nav-item" data-screen="history">
            <div class="nav-icon">
                <i class="fas fa-history"></i>
            </div>
            <span>Istorik</span>
        </div>
        <div class="nav-item" data-screen="ticket-management">
            <div class="nav-icon">
                <i class="fas fa-file-invoice"></i>
            </div>
            <span>Jere fich yo</span>
        </div>
    </div>
    
    <!-- Écran de sélection des paris (réorganisé) -->
    <div class="betting-screen" id="betting-screen">
        <div class="betting-header">
            <button class="back-button" id="back-button">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h2 class="betting-title" id="betting-title">parye</h2>
            <!-- NOUVEAU: Bouton de confirmation de pari en haut -->
            <div style="margin-left: auto;">
                <button class="submit-bet" id="confirm-bet-top" style="padding: 8px 15px; font-size: 0.9rem;">
                    <i class="fas fa-check"></i> Konfime Parye
                </button>
            </div>
        </div>
        
        <!-- NOUVEAU: Notification du total actuel -->
        <div id="total-notification-container" style="margin-bottom: 15px;">
            <!-- La notification du total sera affichée ici -->
        </div>
        
        <!-- Navigation par catégories (optionnelle, affichée seulement pour l'édition) -->
        <div class="bet-type-navigation" id="bet-type-nav" style="display: none;">
            <!-- Sera rempli dynamiquement -->
        </div>
        
        <!-- Interface réorganisée par catégories - TOUTES LES CATÉGORIES VISIBLES -->
        <div id="games-interface" class="all-categories-container">
            <div class="game-category" id="borlette-category">
                <div class="game-category-title">BORLETTE</div>
                <div class="game-category-grid">
                    <div class="game-item borlette" data-game="borlette">
                        <div class="game-name">BORLETTE</div>
                        <div class="game-multiplier">x 60 (1er lot)</div>
                        <small>2 chif - 1er lot ×60, 2e ×20, 3e ×10</small>
                    </div>
                    <div class="game-item borlette" data-game="boulpe">
                        <div class="game-name">BOUL PE</div>
                        <div class="game-multiplier">x 60 (1er lot)</div>
                        <small>Boul pe (00-99)</small>
                    </div>
                </div>
            </div>
            
            <div class="game-category" id="lotto-category">
                <div class="game-category-title">LOTTO</div>
                <div class="game-category-grid">
                    <div class="game-item lotto" data-game="lotto3">
                        <div class="game-name">LOTO 3</div>
                        <div class="game-multiplier">x 500</div>
                        <small>3 chif (lot 1 + 1 chif devan)</small>
                    </div>
                    <div class="game-item lotto" data-game="lotto4">
                        <div class="game-name">LOTO 4</div>
                        <div class="game-multiplier">x 5000</div>
                        <small>4 chif (lot 1+2 accumulate) - 3 opsyon</small>
                    </div>
                    <div class="game-item lotto" data-game="lotto5">
                        <div class="game-name">LOTO 5</div>
                        <div class="game-multiplier">x 25000</div>
                        <small>5 chif (lot 1+2+3 accumulate) - 3 opsyon</small>
                    </div>
                </div>
            </div>
            
            <div class="game-category" id="special-category">
                <div class="game-category-title">JEUX SPÉCIAUX</div>
                <div class="game-category-grid">
                    <div class="game-item special" data-game="grap">
                        <div class="game-name">GRAP</div>
                        <div class="game-multiplier">x 500</div>
                        <small>Boule paire (111, 222...)</small>
                    </div>
                    <div class="game-item special" data-game="marriage">
                        <div class="game-name">MARYAJ</div>
                        <div class="game-multiplier">x 1000</div>
                        <small>Maryaj 2 chif</small>
                    </div>
                    <!-- NOUVEAU: Ajout des jeux automatiques -->
                    <div class="game-item special" data-game="auto-marriage">
                        <div class="game-name">MARYAJ OTOMATIK</div>
                        <div class="game-multiplier">x 1000</div>
                        <small>Marie boules otomatik</small>
                    </div>
                    <div class="game-item special" data-game="auto-lotto4">
                        <div class="game-name">LOTO 4 OTOMATIK</div>
                        <div class="game-multiplier">x 5000</div>
                        <small>Lotto 4 otomatik</small>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Boutons pour les paris automatiques -->
        <div class="auto-buttons" id="auto-buttons" style="display: none;">
            <button class="auto-btn" id="auto-marriage-btn">Maryaj Otomatik</button>
            <button class="auto-btn" id="auto-lotto4-btn">Lotto 4 Otomatik</button>
            <button class="auto-btn reverse" id="reverse-lotto4-btn">Renverse Lotto 4</button>
        </div>
        
        <div class="bet-form" id="bet-form">
            <!-- Le formulaire de pari sera chargé dynamiquement -->
        </div>
        
        <div class="active-bets" id="active-bets">
            <div class="ticket-actions">
                <button class="ticket-action-btn save-print-btn" id="save-print-ticket">
                    <i class="fas fa-save"></i> <i class="fas fa-print"></i> Anrejistre & Enprime Fiche
                </button>
            </div>
            <h3>Parye Aktif</h3>
            <div id="bets-list">
                <!-- Liste des paris actifs -->
            </div>
            <div class="bet-total">
                <span>Total:</span>
                <span id="bet-total">0 goud</span>
            </div>
            <!-- SUPPRIMÉ: Le bouton de confirmation en bas a été retiré -->
        </div>
    </div>
    
    <!-- Écran de gestion des fiches (remplace sync-check) -->
    <div class="screen" id="ticket-management-screen">
        <div class="screen-header">
            <button class="back-button" data-screen="home">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h2 class="screen-title">Jere Fich ou</h2>
        </div>
        
        <div class="ticket-search-box">
            <div class="search-history">
                <input type="text" id="search-ticket-number" class="search-input" placeholder="Chache fiche pa nimewo...">
                <button class="search-btn" id="search-ticket-btn">
                    <i class="fas fa-search"></i> Chache 
                </button>
            </div>
            <div style="margin-top: 10px;">
                <button class="btn-secondary" id="show-all-tickets">Afiche Tout Fich</button>
                <button class="btn-secondary" id="show-pending-tickets">Fiche Pokò ale nan santral</button>
            </div>
        </div>
        
        <div id="ticket-management-list">
            <!-- Les fiches seront chargées dynamiquement -->
        </div>
    </div>
    
    <!-- Écran des fiches -->
    <div class="screen" id="tickets-screen">
        <div class="screen-header">
            <button class="back-button" data-screen="home">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h2 class="screen-title">Fiche Parye</h2>
        </div>
        
        <div class="active-bets">
            <div class="ticket-logo-container">
                <img src="logo-borlette.jpg" alt="Logo Nova Lotto" class="ticket-logo" id="ticket-logo">
            </div>
            <div class="bet-total">
                <span>Nimewo Fiche:</span>
                <span id="ticket-number">#001234</span>
            </div>
            <div class="bet-total">
                <span>Dat:</span>
                <span id="ticket-date">Samdi, 29 Nov - 10:45 AM</span>
            </div>
            <div id="ticket-bets-list">
                <!-- Liste des paris pour la fiche -->
            </div>
            <div class="bet-total">
                <span>Total:</span>
                <span id="ticket-total">0 goud</span>
            </div>
            <div class="ticket-footer">
                <button class="ticket-footer-btn save-ticket" id="save-ticket-only">Sove Fiche</button>
                <button class="ticket-footer-btn print-ticket-btn" id="print-ticket-only">Enprime Fiche</button>
            </div>
        </div>
    </div>
    
    <!-- Écran des fiches gagnantes -->
    <div class="screen" id="winning-tickets-screen">
        <div class="screen-header">
            <button class="back-button" data-screen="home">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h2 class="screen-title">Fich Genyen</h2>
        </div>
        
        <div class="search-history">
            <input type="text" id="search-winning-tickets" class="search-input" placeholder="Chache fiche...">
            <button class="search-btn" id="search-winning-btn">
                <i class="fas fa-search"></i> Chache
            </button>
        </div>
        
        <div id="winning-tickets-list">
            <!-- Les fiches gagnantes seront chargées dynamiquement -->
        </div>
    </div>
    
    <!-- Écran historique -->
    <div class="screen" id="history-screen">
        <div class="screen-header">
            <button class="back-button" data-screen="home">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h2 class="screen-title">Istorik Parye</h2>
        </div>
        
        <div class="search-history">
            <input type="text" id="search-history" class="search-input" placeholder="Chache fiche...">
            <button class="search-btn" id="search-history-btn">
                <i class="fas fa-search"></i> Chache
            </button>
        </div>
        
        <div class="reports-container" id="reports-container">
            <!-- Les boutons de rapport seront chargés dynamiquement -->
        </div>
        
        <div id="report-results">
            <!-- Les résultats des rapports seront chargés dynamiquement -->
        </div>
        
        <div id="history-list">
            <!-- L'historique sera chargé dynamiquement -->
        </div>
    </div>
    <script>
    // Configuration API pour production
    const API_BASE_URL = window.location.origin; // Utilise l'origine actuelle
    const APP_CONFIG = {
        health: `${API_BASE_URL}/api/health`,
        login: `${API_BASE_URL}/api/auth/login`,
        verifyToken: `${API_BASE_URL}/api/auth/verify`,
        draws: `${API_BASE_URL}/api/draws`,
        results: `${API_BASE_URL}/api/results`,
        checkWinners: `${API_BASE_URL}/api/check-winners`,
        bets: `${API_BASE_URL}/api/bets`,
        tickets: `${API_BASE_URL}/api/tickets`,
        multiDrawTickets: `${API_BASE_URL}/api/multi-draw-tickets`,
        reports: `${API_BASE_URL}/api/reports`,
        syncTickets: `${API_BASE_URL}/api/sync-tickets`
    };
    const FIVE_MINUTES = 5 * 60 * 1000;
    
    // Variables globales
    let currentDraw = null;
    let currentDrawTime = null;
    let activeBets = [];
    let ticketNumber = 1;
    let savedTickets = [];
    let currentAdmin = null;
    let pendingSyncTickets = [];
    let isOnline = navigator.onLine;
    let companyLogo = "logo-borlette.jpg";
    let currentBetCategory = null;
    let restrictedBalls = [];
    let gameRestrictions = {};
    let selectedMultiDraws = new Set();
    let selectedMultiGame = 'borlette';
    let selectedBalls = [];
    let draws = {};
    let resultsDatabase = {};
    
    // Variables pour les fiches multi-tirages
    let currentMultiDrawTicket = {
        id: Date.now().toString(),
        bets: [],
        totalAmount: 0,
        draws: new Set(),
        createdAt: new Date().toISOString()
    };
    
    let multiDrawTickets = [];
    let winningTickets = [];
    
    // Informations de l'entreprise
    let companyInfo = {
        name: "Nova Lotto",
        phone: "+509 32 53 49 58",
        address: "Cap Haïtien",
        reportTitle: "Nova Lotto",
        reportPhone: "40104585"
    };
    
    // Types de paris disponibles avec multiplicateurs
    const betTypes = {
        lotto3: {
            name: "LOTO 3",
            multiplier: 500,
            icon: "fas fa-list-ol",
            description: "3 chif (lot 1 + 1 chif devan)",
            category: "lotto"
        },
        grap: {
            name: "GRAP",
            multiplier: 500,
            icon: "fas fa-chart-line",
            description: "Grap boule paire (111, 222, ..., 000)",
            category: "special"
        },
        marriage: {
            name: "MARYAJ",
            multiplier: 1000,
            icon: "fas fa-link",
            description: "Maryaj 2 chif (ex: 12*34)",
            category: "special"
        },
        borlette: {
            name: "BORLETTE",
            multiplier: 60,
            multiplier2: 20,
            multiplier3: 10,
            icon: "fas fa-dice",
            description: "2 chif (1er lot ×60, 2e ×20, 3e ×10)",
            category: "borlette"
        },
        boulpe: {
            name: "BOUL PE",
            multiplier: 60,
            multiplier2: 20,
            multiplier3: 10,
            icon: "fas fa-circle",
            description: "Boul pe (00-99)",
            category: "borlette"
        },
        lotto4: {
            name: "LOTO 4",
            multiplier: 5000,
            icon: "fas fa-list-ol",
            description: "4 chif (lot 1+2 accumulate) - 3 opsyon",
            category: "lotto"
        },
        lotto5: {
            name: "LOTO 5",
            multiplier: 25000,
            icon: "fas fa-list-ol",
            description: "5 chif (lot 1+2+3 accumulate) - 3 opsyon",
            category: "lotto"
        },
        'auto-marriage': {
            name: "MARYAJ OTOMATIK",
            multiplier: 1000,
            icon: "fas fa-robot",
            description: "Marie boules otomatik",
            category: "special"
        },
        'auto-lotto4': {
            name: "LOTO 4 OTOMATIK",
            multiplier: 5000,
            icon: "fas fa-robot",
            description: "Lotto 4 otomatik",
            category: "special"
        }
    };
    
    // Fonction pour récupérer le token
    function getToken() {
        const urlParams = new URLSearchParams(window.location.search);
        const tokenFromUrl = urlParams.get('token');
        const storedToken = localStorage.getItem('nova_token');
        return tokenFromUrl || storedToken;
    }
    
    // Fonction pour les appels API avec authentification
    async function apiFetch(endpoint, options = {}) {
        const token = getToken();
        const headers = {
            'Content-Type': 'application/json',
            ...options.headers
        };
        
        if (token) {
            headers['Authorization'] = `Bearer ${token}`;
        }
        
        try {
            const response = await fetch(endpoint, {
                ...options,
                headers
            });
            
            if (response.status === 401) {
                // Token invalide ou expiré
                localStorage.removeItem('nova_token');
                showNotification("Session expirée, veuillez vous reconnecter", "error");
                document.getElementById('login-screen').style.display = 'block';
                document.getElementById('main-container').style.display = 'none';
                throw new Error('Non autorisé');
            }
            
            const data = await response.json();
            
            if (!data.success) {
                throw new Error(data.error || 'Erreur API');
            }
            
            return data;
        } catch (error) {
            console.error('Erreur API:', error);
            throw error;
        }
    }
    
    // Initialisation
    document.addEventListener('DOMContentLoaded', async function() {
        console.log("Document chargé, initialisation...");
        
        // Récupérer le token depuis l'URL ou le localStorage
        const token = getToken();
        
        if (token) {
            // Vérifier la validité du token
            try {
                const verifyResponse = await fetch(APP_CONFIG.verifyToken + `?token=${encodeURIComponent(token)}`);
                const verifyData = await verifyResponse.json();
                
                if (verifyData.valid) {
                    // Token valide, charger les données
                    await loadInitialData();
                    showMainApp();
                } else {
                    // Token invalide
                    localStorage.removeItem('nova_token');
                    showLoginError("Session expirée, veuillez vous reconnecter");
                }
            } catch (error) {
                console.error("Erreur vérification token:", error);
                showLoginError("Erreur de connexion au serveur");
            }
        }
        
        // Mettre à jour l'heure
        updateCurrentTime();
        
        // Configurer la détection de connexion
        setupConnectionDetection();
        
        // Charger le logo
        loadLogo();
        
        // Ajouter les écouteurs d'événements pour les tirages
        document.querySelectorAll('.draw-card').forEach(card => {
            card.addEventListener('click', function() {
                console.log("Carte de tiraj cliquée:", this.getAttribute('data-draw'));
                const drawId = this.getAttribute('data-draw');
                openBettingScreen(drawId, 'morning');
            });
        });
        
        // Ajouter les écouteurs d'événements pour les boutons de tirage
        document.querySelectorAll('.draw-btn').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.stopPropagation();
                const card = this.closest('.draw-card');
                const drawId = card.getAttribute('data-draw');
                const time = this.getAttribute('data-time');
                
                console.log("Bouton tiraj cliqué:", drawId, time);
                
                card.querySelectorAll('.draw-btn').forEach(b => {
                    b.classList.remove('active');
                });
                this.classList.add('active');
                
                openBettingScreen(drawId, time);
            });
        });
        
        // Bouton de retour
        document.getElementById('back-button').addEventListener('click', closeBettingScreen);
        
        // Bouton de confirmation en haut
        document.getElementById('confirm-bet-top').addEventListener('click', submitBets);
        
        // Boutons de fiche
        document.getElementById('save-print-ticket').addEventListener('click', function() {
            console.log("Sauvegarder et imprimer cliqué");
            checkConnectionBeforeSavePrint();
        });
        
        document.getElementById('save-ticket-only').addEventListener('click', function() {
            console.log("Sauvegarder seulement cliqué");
            saveTicket();
        });
        
        document.getElementById('print-ticket-only').addEventListener('click', function() {
            console.log("Imprimer seulement cliqué");
            checkConnectionBeforePrint();
        });
        
        // Bouton pour sauvegarder et imprimer la fiche multi-tirages
        document.getElementById('save-print-multi-ticket').addEventListener('click', function() {
            console.log("Sauvegarder et imprimer fiche multi-tirages");
            saveAndPrintMultiDrawTicket();
        });
        
        // Bouton pour voir la fiche multi-tirages actuelle
        document.getElementById('view-current-multi-ticket').addEventListener('click', function() {
            console.log("Voir fiche multi-tirages actuelle");
            viewCurrentMultiDrawTicket();
        });
        
        // Bouton pour ouvrir l'écran des fiches multi-tirages
        document.getElementById('open-multi-tickets').addEventListener('click', function() {
            console.log("Ouvrir écran fiches multi-tirages");
            openMultiTicketsScreen();
        });
        
        // Bouton de retour de l'écran multi-tirages
        document.getElementById('back-from-multi-tickets').addEventListener('click', function() {
            console.log("Retour de l'écran multi-tirages");
            document.getElementById('multi-tickets-screen').style.display = 'none';
            document.querySelector('.container').style.display = 'block';
        });
        
        // Navigation
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', function() {
                const screen = this.getAttribute('data-screen');
                console.log("Navigation cliquée:", screen);
                showScreen(screen);
            });
        });
        
        // Boutons de retour
        document.querySelectorAll('.back-button').forEach(btn => {
            btn.addEventListener('click', function() {
                const screen = this.getAttribute('data-screen') || 'home';
                console.log("Bouton retour cliqué vers:", screen);
                showScreen(screen);
            });
        });
        
        // Bouton retour du rapport
        document.getElementById('back-from-report').addEventListener('click', function() {
            console.log("Retour du rapport");
            document.getElementById('report-screen').style.display = 'none';
            document.querySelector('.container').style.display = 'block';
        });
        
        // Bouton retour de vérification des résultats
        document.getElementById('back-from-results').addEventListener('click', function() {
            console.log("Retour de vérification des résultats");
            document.getElementById('results-check-screen').style.display = 'none';
            document.querySelector('.container').style.display = 'block';
        });
        
        // Connexion
        document.getElementById('login-btn').addEventListener('click', function() {
            console.log("Bouton login cliqué");
            adminLogin();
        });
        
        document.getElementById('admin-password').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                console.log("Entrée pressée dans mot de passe");
                adminLogin();
            }
        });
        
        // Boutons de connexion
        document.getElementById('retry-connection').addEventListener('click', function() {
            console.log("Réessayer connexion");
            retryConnectionCheck();
        });
        
        document.getElementById('cancel-print').addEventListener('click', function() {
            console.log("Annuler impression");
            cancelPrint();
        });
        
        // Bouton pour générer le rapport
        document.getElementById('generate-report-btn').addEventListener('click', function() {
            console.log("Générer rapport");
            generateEndOfDrawReport();
        });
        
        // Bouton pour ouvrir l'écran de vérification des résultats
        document.getElementById('open-results-check').addEventListener('click', function() {
            console.log("Ouvrir vérification des résultats");
            openResultsCheckScreen();
        });
        
        // Bouton pour vérifier les fiches gagnantes
        document.getElementById('check-winners-btn').addEventListener('click', function() {
            console.log("Vérifier fiches gagnantes");
            checkWinningTickets();
        });
        
        // Multi-tirages
        document.getElementById('multi-draw-toggle').addEventListener('click', function() {
            console.log("Toggle multi-tirages");
            toggleMultiDrawPanel();
        });
        
        // Changement du bouton pour ajouter à la fiche multi-tirages
        document.getElementById('add-to-multi-draw').addEventListener('click', function() {
            console.log("Ajouter à la fiche multi-tirages");
            addToMultiDrawTicket();
        });
        
        // Initialiser le panneau multi-tirages
        initMultiDrawPanel();
        
        // Gestion des fiches
        document.getElementById('search-ticket-btn').addEventListener('click', function() {
            console.log("Rechercher fiche");
            searchTicket();
        });
        
        document.getElementById('show-all-tickets').addEventListener('click', function() {
            console.log("Afficher toutes les fiches");
            showAllTickets();
        });
        
        document.getElementById('show-pending-tickets').addEventListener('click', function() {
            console.log("Afficher fiches en attente");
            showPendingTickets();
        });
        
        // Recherche historique
        document.getElementById('search-history-btn').addEventListener('click', function() {
            console.log("Rechercher historique");
            searchHistory();
        });
        
        document.getElementById('search-winning-btn').addEventListener('click', function() {
            console.log("Rechercher fiches gagnantes");
            searchWinningTickets();
        });
        
        // Actualiser périodiquement
        setInterval(updateCurrentTime, 60000);
        setInterval(updatePendingBadge, 30000);
        setInterval(checkForNewResults, 300000);
        
        console.log("Initialisation terminée");
    });
    
    // Charger les données initiales
    async function loadInitialData() {
        console.log("Chargement des données initiales...");
        
        try {
            // Charger les tirages depuis l'API
            await loadDrawsFromAPI();
            
            // Charger les résultats depuis l'API
            await loadResultsFromAPI();
            
            // Charger les données sauvegardées
            loadSavedData();
            
            // Charger les fiches multi-tirages
            await loadMultiDrawTicketsFromAPI();
            
            console.log("Données initiales chargées avec succès");
        } catch (error) {
            console.error("Erreur lors du chargement des données initiales:", error);
            showNotification("Erreur de chargement des données", "error");
        }
    }
    
    // Charger les tirages depuis l'API
    async function loadDrawsFromAPI() {
        console.log("Chargement des tirages depuis l'API...");
        
        try {
            const data = await apiFetch(APP_CONFIG.draws);
            draws = data.draws;
            
            // Mettre à jour l'affichage des tirages
            updateDrawsDisplay();
            
            console.log("Tirages chargés:", Object.keys(draws).length);
        } catch (error) {
            console.error("Erreur lors du chargement des tirages:", error);
            showNotification("Erreur chargement tirages", "error");
        }
    }
    
    // Charger les résultats depuis l'API
    async function loadResultsFromAPI() {
        console.log("Chargement des résultats depuis l'API...");
        
        try {
            const data = await apiFetch(APP_CONFIG.results);
            resultsDatabase = data.results;
            
            // Mettre à jour l'affichage des résultats
            updateResultsDisplay();
            
            console.log("Résultats chargés");
        } catch (error) {
            console.error("Erreur lors du chargement des résultats:", error);
            showNotification("Erreur chargement résultats", "error");
        }
    }
    
    // Charger les fiches multi-tirages depuis l'API
    async function loadMultiDrawTicketsFromAPI() {
        console.log("Chargement des fiches multi-tirages depuis l'API...");
        
        try {
            const data = await apiFetch(APP_CONFIG.multiDrawTickets);
            multiDrawTickets = data.tickets || [];
            
            console.log(`${multiDrawTickets.length} fiches multi-tirages chargées`);
        } catch (error) {
            console.error("Erreur lors du chargement des fiches multi-tirages:", error);
            showNotification("Erreur chargement fiches multi-tirages", "error");
        }
    }
    
    // Mettre à jour l'affichage des tirages
    function updateDrawsDisplay() {
        console.log("Mise à jour affichage des tirages");
        
        const drawsContainer = document.querySelector('.draws-container');
        if (!drawsContainer) return;
        
        drawsContainer.innerHTML = '';
        
        Object.keys(draws).forEach(drawId => {
            const draw = draws[drawId];
            const drawCard = document.createElement('div');
            drawCard.className = `draw-card ${drawId}`;
            drawCard.setAttribute('data-draw', drawId);
            
            drawCard.innerHTML = `
                <div class="draw-icon">
                    <i class="${draw.icon || 'fas fa-dice'}"></i>
                </div>
                <h3>${draw.name}</h3>
                <div class="draw-buttons">
                    <button class="draw-btn morning active" data-time="morning">${draw.times.morning}</button>
                    <button class="draw-btn evening" data-time="evening">${draw.times.evening}</button>
                </div>
                <div class="draw-countdown">${draw.countdown}</div>
            `;
            
            drawsContainer.appendChild(drawCard);
        });
        
        // Réattacher les événements
        document.querySelectorAll('.draw-card').forEach(card => {
            card.addEventListener('click', function() {
                const drawId = this.getAttribute('data-draw');
                openBettingScreen(drawId, 'morning');
            });
        });
        
        document.querySelectorAll('.draw-btn').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.stopPropagation();
                const card = this.closest('.draw-card');
                const drawId = card.getAttribute('data-draw');
                const time = this.getAttribute('data-time');
                
                card.querySelectorAll('.draw-btn').forEach(b => {
                    b.classList.remove('active');
                });
                this.classList.add('active');
                
                openBettingScreen(drawId, time);
            });
        });
    }
    
    // Mettre à jour l'affichage des résultats
    function updateResultsDisplay() {
        console.log("Mise à jour affichage des résultats");
        
        // Mettre à jour les résultats dans la section principale
        const resultsGrid = document.querySelector('.results-grid');
        if (resultsGrid) {
            resultsGrid.innerHTML = '';
            
            Object.keys(draws).forEach(drawId => {
                const resultCard = document.createElement('div');
                resultCard.className = 'result-card';
                
                // Prendre le dernier résultat disponible (matin par défaut)
                const result = resultsDatabase[drawId]?.morning || { lot1: '---' };
                
                resultCard.innerHTML = `
                    <h4>${draws[drawId].name}</h4>
                    <div class="result-number">${result.lot1}</div>
                `;
                
                resultsGrid.appendChild(resultCard);
            });
        }
        
        // Mettre à jour l'écran de vérification des résultats
        const latestResults = document.getElementById('latest-results');
        if (latestResults) {
            latestResults.innerHTML = '';
            
            Object.keys(draws).forEach(drawId => {
                Object.keys(draws[drawId].times).forEach(time => {
                    const result = resultsDatabase[drawId]?.[time];
                    if (result) {
                        const resultDiv = document.createElement('div');
                        resultDiv.className = 'lot-result';
                        
                        const timeName = time === 'morning' ? 'Maten' : 'Swè';
                        resultDiv.innerHTML = `
                            <div>
                                <strong>${draws[drawId].name} ${timeName}</strong><br>
                                <small>${new Date(result.date).toLocaleString()}</small>
                            </div>
                            <div style="text-align: right;">
                                <div class="lot-number">${result.lot1}</div>
                                <div>${result.lot2} (×20)</div>
                                <div>${result.lot3} (×10)</div>
                            </div>
                        `;
                        
                        latestResults.appendChild(resultDiv);
                    }
                });
            });
        }
    }
    
    // Ouvrir l'écran de vérification des résultats
    function openResultsCheckScreen() {
        console.log("Ouverture écran vérification résultats");
        
        document.querySelector('.container').style.display = 'none';
        document.getElementById('results-check-screen').style.display = 'block';
        
        // Mettre à jour l'affichage des résultats
        updateResultsDisplay();
        
        // Réinitialiser l'affichage des fiches gagnantes
        document.getElementById('winning-tickets-container').innerHTML = '';
        document.getElementById('winning-summary').innerHTML = '';
    }
    
    // Vérifier les tickets gagnants
    async function checkWinningTickets() {
        console.log("Vérification des tickets gagnants...");
        
        try {
            const data = await apiFetch(APP_CONFIG.checkWinners, {
                method: 'POST',
                body: JSON.stringify({
                    tickets: [...savedTickets, ...pendingSyncTickets],
                    results: resultsDatabase
                })
            });
            
            winningTickets = data.winningTickets || [];
            
            displayWinningTickets();
            
            if (winningTickets.length > 0) {
                showNotification(`${winningTickets.length} fiche gagnant detekte!`, "success");
            } else {
                showNotification("Pa gen fiche genyen pou moman sa", "info");
            }
        } catch (error) {
            console.error("Erreur vérification tickets gagnants:", error);
            showNotification("Erreur vérification tickets gagnants", "error");
        }
    }
    
    // Vérifier un pari contre un résultat
    function checkBetAgainstResult(bet, result) {
        // Extraire les lots
        const lot1 = result.lot1; // 3 chiffres
        const lot2 = result.lot2; // 2 chiffres
        const lot3 = result.lot3; // 2 chiffres
        
        // Derniers 2 chiffres du lot 1 (pour borlette 1er lot)
        const lot1Last2 = lot1.substring(1); // Prend les 2 derniers chiffres
        
        let isWinner = false;
        let winAmount = 0;
        let winType = '';
        let matchedNumber = '';
        
        switch(bet.type) {
            case 'borlette':
                // Vérifier contre les 3 lots
                if (bet.number === lot1Last2) {
                    // 1er lot
                    isWinner = true;
                    winAmount = bet.amount * 60; // ×60
                    winType = '1er lot';
                    matchedNumber = lot1Last2;
                } else if (bet.number === lot2) {
                    // 2e lot
                    isWinner = true;
                    winAmount = bet.amount * 20; // ×20
                    winType = '2e lot';
                    matchedNumber = lot2;
                } else if (bet.number === lot3) {
                    // 3e lot
                    isWinner = true;
                    winAmount = bet.amount * 10; // ×10
                    winType = '3e lot';
                    matchedNumber = lot3;
                }
                break;
                
            case 'boulpe':
                // Même logique que borlette pour les boules paires
                if (bet.number === lot1Last2) {
                    isWinner = true;
                    winAmount = bet.amount * 60;
                    winType = '1er lot';
                    matchedNumber = lot1Last2;
                } else if (bet.number === lot2) {
                    isWinner = true;
                    winAmount = bet.amount * 20;
                    winType = '2e lot';
                    matchedNumber = lot2;
                } else if (bet.number === lot3) {
                    isWinner = true;
                    winAmount = bet.amount * 10;
                    winType = '3e lot';
                    matchedNumber = lot3;
                }
                break;
                
            case 'lotto3':
                // Lotto 3: vérifier contre le lot 1 (3 chiffres)
                if (bet.number === lot1) {
                    isWinner = true;
                    winAmount = bet.amount * 500; // ×500
                    winType = 'Lotto 3';
                    matchedNumber = lot1;
                }
                break;
                
            case 'lotto4':
                // Règles Lotto 4 avec 3 options
                winAmount = 0;
                winType = '';
                
                // Option 1: lot2 + lot3 (ex: 45 + 34 = 4534)
                if (bet.options?.option1) {
                    const option1Result = lot2 + lot3;
                    if (bet.number === option1Result) {
                        isWinner = true;
                        winAmount += bet.perOptionAmount * 5000;
                        winType += 'Opsyon 1, ';
                        matchedNumber = option1Result;
                    }
                }
                
                // Option 2: derniers 2 chiffres de lot1 + lot2 (ex: 23 + 45 = 2345)
                if (bet.options?.option2) {
                    const option2Result = lot1.substring(1) + lot2;
                    if (bet.number === option2Result) {
                        isWinner = true;
                        winAmount += bet.perOptionAmount * 5000;
                        winType += 'Opsyon 2, ';
                        matchedNumber = option2Result;
                    }
                }
                
                // Option 3: n'importe quel arrangement contenant lot2 et lot3
                if (bet.options?.option3) {
                    // Vérifier si les 4 chiffres contiennent les deux boules (lot2 et lot3)
                    const betDigits = bet.number.split('');
                    const lot2Digits = lot2.split('');
                    const lot3Digits = lot3.split('');
                    
                    // Créer une copie des chiffres pour vérification
                    const tempDigits = [...betDigits];
                    let containsLot2 = true;
                    let containsLot3 = true;
                    
                    // Vérifier lot2
                    for (const digit of lot2Digits) {
                        const index = tempDigits.indexOf(digit);
                        if (index === -1) {
                            containsLot2 = false;
                            break;
                        }
                        tempDigits.splice(index, 1);
                    }
                    
                    // Vérifier lot3
                    for (const digit of lot3Digits) {
                        const index = tempDigits.indexOf(digit);
                        if (index === -1) {
                            containsLot3 = false;
                            break;
                        }
                        tempDigits.splice(index, 1);
                    }
                    
                    if (containsLot2 && containsLot3) {
                        isWinner = true;
                        winAmount += bet.perOptionAmount * 5000;
                        winType += 'Opsyon 3, ';
                        matchedNumber = bet.number;
                    }
                }
                break;
                
            case 'lotto5':
                // Règles Lotto 5 avec 3 options
                winAmount = 0;
                winType = '';
                
                // Option 1: lot1 + lot2 (ex: 123 + 45 = 12345)
                if (bet.options?.option1) {
                    const option1Result = lot1 + lot2;
                    if (bet.number === option1Result) {
                        isWinner = true;
                        winAmount += bet.perOptionAmount * 25000;
                        winType += 'Opsyon 1, ';
                        matchedNumber = option1Result;
                    }
                }
                
                // Option 2: lot1 + lot3 (ex: 123 + 34 = 12334)
                if (bet.options?.option2) {
                    const option2Result = lot1 + lot3;
                    if (bet.number === option2Result) {
                        isWinner = true;
                        winAmount += bet.perOptionAmount * 25000;
                        winType += 'Opsyon 2, ';
                        matchedNumber = option2Result;
                    }
                }
                
                // Option 3: n'importe quel arrangement contenant les chiffres des 3 lots
                if (bet.options?.option3) {
                    // Les 5 chiffres doivent contenir tous les chiffres des 3 lots
                    const allResultDigits = (lot1 + lot2 + lot3).split('');
                    const betDigits = bet.number.split('');
                    
                    let allFound = true;
                    const tempResultDigits = [...allResultDigits];
                    
                    for (const digit of betDigits) {
                        const index = tempResultDigits.indexOf(digit);
                        if (index === -1) {
                            allFound = false;
                            break;
                        }
                        tempResultDigits.splice(index, 1);
                    }
                    
                    if (allFound) {
                        isWinner = true;
                        winAmount += bet.perOptionAmount * 25000;
                        winType += 'Opsyon 3, ';
                        matchedNumber = bet.number;
                    }
                }
                break;
                
            case 'marriage':
            case 'auto-marriage':
                // Mariage: vérifier si les deux nombres sont présents dans les lots
                const [num1, num2] = bet.number.split('*');
                const numbers = [lot1Last2, lot2, lot3];
                
                if (numbers.includes(num1) && numbers.includes(num2)) {
                    isWinner = true;
                    winAmount = bet.amount * 1000; // ×1000
                    winType = 'Maryaj';
                    matchedNumber = `${num1}*${num2}`;
                }
                break;
                
            case 'grap':
                // Grap: vérifier si le lot1 est un grap (3 chiffres identiques)
                if (lot1[0] === lot1[1] && lot1[1] === lot1[2]) {
                    if (bet.number === lot1) {
                        isWinner = true;
                        winAmount = bet.amount * 500; // ×500
                        winType = 'Grap';
                        matchedNumber = lot1;
                    }
                }
                break;
                
            case 'auto-lotto4':
                // Même logique que lotto4 option 3 (arrangement quelconque)
                const lotto4Digits = bet.number.split('');
                const autoLot2Digits = lot2.split('');
                const autoLot3Digits = lot3.split('');
                
                const autoTempDigits = [...lotto4Digits];
                let autoContainsLot2 = true;
                let autoContainsLot3 = true;
                
                // Vérifier lot2
                for (const digit of autoLot2Digits) {
                    const index = autoTempDigits.indexOf(digit);
                    if (index === -1) {
                        autoContainsLot2 = false;
                        break;
                    }
                    autoTempDigits.splice(index, 1);
                }
                
                // Vérifier lot3
                for (const digit of autoLot3Digits) {
                    const index = autoTempDigits.indexOf(digit);
                    if (index === -1) {
                        autoContainsLot3 = false;
                        break;
                    }
                    autoTempDigits.splice(index, 1);
                }
                
                if (autoContainsLot2 && autoContainsLot3) {
                    isWinner = true;
                    winAmount = bet.amount * 5000;
                    winType = 'Lotto 4 Auto';
                    matchedNumber = bet.number;
                }
                break;
        }
        
        return {
            isWinner,
            winAmount,
            winType,
            matchedNumber
        };
    }
    
    // Afficher les tickets gagnants
    function displayWinningTickets() {
        const container = document.getElementById('winning-tickets-container');
        const summary = document.getElementById('winning-summary');
        
        container.innerHTML = '';
        
        if (winningTickets.length === 0) {
            container.innerHTML = `
                <div style="text-align: center; padding: 20px; color: #7f8c8d;">
                    <i class="fas fa-info-circle" style="font-size: 2rem; margin-bottom: 10px;"></i>
                    <p>Pa gen fiche gagnant pou moman sa.</p>
                </div>
            `;
            summary.innerHTML = '';
            return;
        }
        
        // Calculer le total des gains
        const totalWinnings = winningTickets.reduce((sum, ticket) => sum + ticket.totalWinnings, 0);
        
        // Afficher le résumé
        summary.innerHTML = `
            <div class="stat-card">
                <div class="stat-value">${winningTickets.length}</div>
                <div class="stat-label">Fiche Gagnant</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">${totalWinnings} G</div>
                <div class="stat-label">Total Gains</div>
            </div>
        `;
        
        // Afficher chaque ticket gagnant
        winningTickets.forEach(ticket => {
            const ticketDiv = document.createElement('div');
            ticketDiv.className = 'winning-ticket';
            
            let betsHTML = '';
            ticket.winningBets.forEach(winBet => {
                betsHTML += `
                    <div class="bet-item">
                        <div class="bet-details">
                            <strong>${winBet.name}</strong><br>
                            ${winBet.number} → ${winBet.matchedNumber || winBet.number} (${winBet.winType})
                        </div>
                        <div class="bet-amount">
                            <span class="winning-amount">+${winBet.winAmount} G</span>
                        </div>
                    </div>
                `;
            });
            
            ticketDiv.innerHTML = `
                <div style="margin-bottom: 10px;">
                    <strong>Fiche #${String(ticket.number).padStart(6, '0')}</strong>
                    <div style="font-size: 0.9rem; color: #7f8c8d;">
                        ${draws[ticket.draw].name} (${ticket.drawTime === 'morning' ? 'Maten' : 'Swè'})
                    </div>
                </div>
                <div style="margin-bottom: 10px;">
                    <strong>Rezilta:</strong> ${ticket.result.lot1} | ${ticket.result.lot2} | ${ticket.result.lot3}
                </div>
                ${betsHTML}
                <div class="bet-total">
                    <span>Total Gains:</span>
                    <span class="winning-amount">${ticket.totalWinnings} G</span>
                </div>
            `;
            
            container.appendChild(ticketDiv);
        });
    }
    
    // Connexion administrateur
    async function adminLogin() {
        console.log("Tentative de connexion");
        const username = document.getElementById('admin-username').value.trim();
        const password = document.getElementById('admin-password').value.trim();
        
        if (!username || !password) {
            showLoginError("Tanpri antre identifian ak modpas la");
            return;
        }
        
        try {
            const response = await fetch(APP_CONFIG.login, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    username: username,
                    password: password,
                    role: 'agent'
                })
            });
            
            const data = await response.json();
            
            if (data.success) {
                // Stocker le token
                localStorage.setItem('nova_token', data.token);
                
                // Charger les données
                await loadInitialData();
                
                showMainApp();
                showNotification("Koneksyon reyisi!", "success");
            } else {
                showLoginError(data.error || "Identifian oswa modpas la pa kòrèk");
            }
        } catch (error) {
            console.error('Erreur connexion:', error);
            showLoginError("Erè koneksyon sèvè");
        }
    }
    
    // Afficher l'application principale
    function showMainApp() {
        console.log("Affichage application principale");
        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('main-container').style.display = 'block';
        document.getElementById('bottom-nav').style.display = 'flex';
        document.getElementById('sync-status').style.display = 'flex';
        document.getElementById('admin-panel').style.display = 'block';
    }
    
    // Afficher l'erreur de connexion
    function showLoginError(message = "Identifian oswa modpas la pa kòrèk.") {
        document.getElementById('login-error').textContent = message;
        document.getElementById('login-error').style.display = 'block';
    }
    
    // Charger les données sauvegardées
    function loadSavedData() {
        console.log("Chargement données sauvegardées");
        const savedTicketsData = localStorage.getItem('novaLottoTickets');
        if (savedTicketsData) {
            savedTickets = JSON.parse(savedTicketsData);
        }
        
        const savedTicketNumber = localStorage.getItem('novaLottoTicketNumber');
        if (savedTicketNumber) {
            ticketNumber = parseInt(savedTicketNumber);
        }
        
        const savedPendingSync = localStorage.getItem('novaLottoPendingSync');
        if (savedPendingSync) {
            pendingSyncTickets = JSON.parse(savedPendingSync);
        }
        
        const savedWinningTickets = localStorage.getItem('novaLottoWinningTickets');
        if (savedWinningTickets) {
            winningTickets = JSON.parse(savedWinningTickets);
        }
        
        console.log("Données chargées:", { 
            tickets: savedTickets.length, 
            ticketNumber, 
            pending: pendingSyncTickets.length,
            winning: winningTickets.length
        });
    }
    
    // Configurer la détection de connexion
    function setupConnectionDetection() {
        window.addEventListener('online', function() {
            isOnline = true;
            showNotification("Koneksyon entènèt retabli", "success");
            checkForNewResults();
        });
        
        window.addEventListener('offline', function() {
            isOnline = false;
            showNotification("Pa konekte ak entènèt", "warning");
        });
    }
    
    // Afficher une notification
    function showNotification(message, type = 'info') {
        console.log("Notification:", type, message);
        const notification = document.createElement('div');
        notification.className = `notification ${type}`;
        
        let icon = 'fas fa-info-circle';
        if (type === 'success') icon = 'fas fa-check-circle';
        if (type === 'warning') icon = 'fas fa-exclamation-triangle';
        if (type === 'error') icon = 'fas fa-times-circle';
        
        notification.innerHTML = `
            <i class="${icon}"></i>
            <span>${message}</span>
        `;
        
        document.body.appendChild(notification);
        
        setTimeout(() => {
            notification.style.opacity = '0';
            notification.style.transform = 'translate(-50%, 20px)';
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 300);
        }, 5000);
    }
    
    // Mettre à jour l'heure actuelle
    function updateCurrentTime() {
        const now = new Date();
        const options = { weekday: 'long', year: 'numeric', month: 'short', day: 'numeric' };
        const dateString = now.toLocaleDateString('fr-FR', options);
        const timeString = now.toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' });
        
        document.getElementById('current-time').textContent = `${dateString} - ${timeString}`;
        document.getElementById('ticket-date').textContent = `${dateString} - ${timeString}`;
    }
    
    // Ouvrir l'écran de pari
    function openBettingScreen(drawId, time = null) {
        console.log("Ouvrir écran pari:", drawId, time);
        currentDraw = drawId;
        currentDrawTime = time;
        const draw = draws[drawId];
        
        let title = draw.name;
        if (time) {
            title += ` (${time === 'morning' ? 'Maten' : 'Swè'})`;
        }
        document.getElementById('betting-title').textContent = title;
        
        const bettingScreen = document.getElementById('betting-screen');
        bettingScreen.style.display = 'block';
        bettingScreen.classList.remove('slide-out');
        bettingScreen.classList.add('slide-in');
        
        document.querySelector('.container').style.display = 'none';
        
        // Afficher TOUTES les catégories de jeux
        document.getElementById('games-interface').style.display = 'block';
        document.getElementById('bet-type-nav').style.display = 'none';
        document.getElementById('auto-buttons').style.display = 'none';
        document.getElementById('bet-form').style.display = 'none';
        document.getElementById('active-bets').style.display = 'block';
        
        // Configurer les événements des jeux
        setupGameSelection();
        
        updateBetsList();
    }
    
    // Configurer la sélection des jeux
    function setupGameSelection() {
        console.log("Configuration sélection jeux");
        // Retirer d'abord les anciens écouteurs
        const existingItems = document.querySelectorAll('.game-item');
        existingItems.forEach(item => {
            item.replaceWith(item.cloneNode(true));
        });
        
        // Ajouter les nouveaux écouteurs
        document.querySelectorAll('.game-item').forEach(item => {
            item.addEventListener('click', function() {
                const gameType = this.getAttribute('data-game');
                console.log("Jeu sélectionné:", gameType);
                
                if (gameType === 'auto-marriage' || gameType === 'auto-lotto4') {
                    showAutoGameForm(gameType);
                } else {
                    showBetForm(gameType);
                }
            });
        });
    }
    
    // Afficher le formulaire de pari
    function showBetForm(gameType) {
        console.log("Afficher formulaire pour:", gameType);
        const bet = betTypes[gameType];
        
        // Cacher l'interface des jeux
        document.getElementById('games-interface').style.display = 'none';
        document.getElementById('bet-type-nav').style.display = 'none';
        document.getElementById('auto-buttons').style.display = 'none';
        
        const betForm = document.getElementById('bet-form');
        betForm.style.display = 'block';
        
        let formHTML = '';
        
        switch(gameType) {
            case 'lotto3':
                formHTML = `
                    <h3>${bet.name} - ${bet.description}</h3>
                    <p class="info-text"><small>Chwazi 3 chif (lot 1 + 1 chif devan)</small></p>
                    <div class="quick-bet-form">
                        <input type="text" id="lotto3-number" class="quick-number-input" 
                               placeholder="000" maxlength="3" pattern="[0-9]{3}"
                               title="Antre 3 chif (0-9)">
                        <input type="number" id="lotto3-amount" class="quick-amount-input" 
                               placeholder="Kantite" min="1">
                        <button class="btn-primary" id="add-bet">Ajoute</button>
                    </div>
                    <div class="bet-actions">
                        <button class="btn-secondary" id="return-to-types">Retounen</button>
                    </div>
                `;
                break;
                
            case 'marriage':
                formHTML = `
                    <h3>${bet.name} - ${bet.description}</h3>
                    <div class="form-group">
                        <label>2 Chif yo</label>
                        <div class="number-inputs">
                            <input type="text" id="marriage-number1" placeholder="00" maxlength="2" pattern="[0-9]{2}">
                            <input type="text" id="marriage-number2" placeholder="00" maxlength="2" pattern="[0-9]{2}">
                        </div>
                    </div>
                    <div class="quick-bet-form">
                        <input type="number" id="marriage-amount" class="quick-amount-input" placeholder="Kantite" min="1">
                        <button class="btn-primary" id="add-bet">Ajoute</button>
                    </div>
                    <div class="bet-actions">
                        <button class="btn-secondary" id="return-to-types">Retounen</button>
                    </div>
                `;
                break;
                
            case 'borlette':
                formHTML = `
                    <h3>${bet.name} - ${bet.description}</h3>
                    <p class="info-text"><small>1er lot ×60, 2e lot ×20, 3e lot ×10</small></p>
                    <div class="quick-bet-form">
                        <input type="text" id="borlette-number" class="quick-number-input" placeholder="00" maxlength="2" pattern="[0-9]{2}">
                        <input type="number" id="borlette-amount" class="quick-amount-input" placeholder="Kantite" min="1">
                        <button class="btn-primary" id="add-bet">Ajoute</button>
                    </div>
                    <div class="bet-actions">
                        <button class="btn-secondary" id="return-to-types">Retounen</button>
                    </div>
                    <div class="n-balls-container">
                        <div class="n-ball" data-n="0">N0</div>
                        <div class="n-ball" data-n="1">N1</div>
                        <div class="n-ball" data-n="2">N2</div>
                        <div class="n-ball" data-n="3">N3</div>
                        <div class="n-ball" data-n="4">N4</div>
                        <div class="n-ball" data-n="5">N5</div>
                        <div class="n-ball" data-n="6">N6</div>
                        <div class="n-ball" data-n="7">N7</div>
                        <div class="n-ball" data-n="8">N8</div>
                        <div class="n-ball" data-n="9">N9</div>
                    </div>
                `;
                break;
                
            case 'boulpe':
                formHTML = `
                    <h3>${bet.name} - ${bet.description}</h3>
                    <p class="info-text"><small>1er lot ×60, 2e lot ×20, 3e lot ×10</small></p>
                    <div class="quick-bet-form">
                        <input type="text" id="boulpe-number" class="quick-number-input" placeholder="00" maxlength="2" pattern="[0-9]{2}">
                        <input type="number" id="boulpe-amount" class="quick-amount-input" placeholder="Kantite" min="1">
                        <button class="btn-primary" id="add-bet">Ajoute</button>
                    </div>
                    <div class="bet-actions">
                        <button class="btn-secondary" id="return-to-types">Retounen</button>
                    </div>
                    <div class="n-balls-container">
                        <div class="n-ball" data-number="00">00</div>
                        <div class="n-ball" data-number="11">11</div>
                        <div class="n-ball" data-number="22">22</div>
                        <div class="n-ball" data-number="33">33</div>
                        <div class="n-ball" data-number="44">44</div>
                        <div class="n-ball" data-number="55">55</div>
                        <div class="n-ball" data-number="66">66</div>
                        <div class="n-ball" data-number="77">77</div>
                        <div class="n-ball" data-number="88">88</div>
                        <div class="n-ball" data-number="99">99</div>
                        <div class="bo-ball" id="bo-all">BO</div>
                    </div>
                `;
                break;
                
            case 'lotto4':
                formHTML = `
                    <h3>${bet.name} - ${bet.description}</h3>
                    <p class="info-text"><small>4 chif (lot 1+2 accumulate) - 3 opsyon</small></p>
                    
                    <div class="form-group">
                        <label>4 Chif yo</label>
                        <div class="number-inputs">
                            <input type="text" id="lotto4-number1" placeholder="00" maxlength="2" pattern="[0-9]{2}">
                            <input type="text" id="lotto4-number2" placeholder="00" maxlength="2" pattern="[0-9]{2}">
                        </div>
                    </div>
                    
                    <div class="options-container">
                        <div class="option-checkbox">
                            <input type="checkbox" id="lotto4-option1" checked>
                            <label for="lotto4-option1">
                                <strong>Opsyon 1:</strong> lot2 + lot3 (ex: 45 + 34 = 4534)
                            </label>
                            <span class="option-multiplier">×5000</span>
                        </div>
                        
                        <div class="option-checkbox">
                            <input type="checkbox" id="lotto4-option2" checked>
                            <label for="lotto4-option2">
                                <strong>Opsyon 2:</strong> 2 dènye chif lot1 + lot2 (ex: 23 + 45 = 2345)
                            </label>
                            <span class="option-multiplier">×5000</span>
                        </div>
                        
                        <div class="option-checkbox">
                            <input type="checkbox" id="lotto4-option3" checked>
                            <label for="lotto4-option3">
                                <strong>Opsyon 3:</strong> N'importe lòd lot2 ak lot3 (ex: 4523, 3423, 4534, etc.)
                            </label>
                            <span class="option-multiplier">×5000</span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="lotto4-amount">Kantite pa opsyon</label>
                        <input type="number" id="lotto4-amount" placeholder="Kantite" min="1" value="1">
                        <small style="color: #7f8c8d;">Total = kantite × nimewo opsyon chwazi</small>
                    </div>
                    
                    <div class="bet-actions">
                        <button class="btn-primary" id="add-bet">Ajoute</button>
                        <button class="btn-secondary" id="return-to-types">Retounen</button>
                    </div>
                `;
                break;
                
            case 'lotto5':
                formHTML = `
                    <h3>${bet.name} - ${bet.description}</h3>
                    <p class="info-text"><small>5 chif (lot 1+2+3 accumulate) - 3 opsyon</small></p>
                    
                    <div class="form-group">
                        <label>5 Chif yo</label>
                        <div class="number-inputs">
                            <input type="text" id="lotto5-number1" placeholder="000" maxlength="3" pattern="[0-9]{3}">
                            <input type="text" id="lotto5-number2" placeholder="00" maxlength="2" pattern="[0-9]{2}">
                        </div>
                    </div>
                    
                    <div class="options-container">
                        <div class="option-checkbox">
                            <input type="checkbox" id="lotto5-option1" checked>
                            <label for="lotto5-option1">
                                <strong>Opsyon 1:</strong> lot1 + lot2 (ex: 123 + 45 = 12345)
                            </label>
                            <span class="option-multiplier">×25000</span>
                        </div>
                        
                        <div class="option-checkbox">
                            <input type="checkbox" id="lotto5-option2" checked>
                            <label for="lotto5-option2">
                                <strong>Opsyon 2:</strong> lot1 + lot3 (ex: 123 + 34 = 12334)
                            </label>
                            <span class="option-multiplier">×25000</span>
                        </div>
                        
                        <div class="option-checkbox">
                            <input type="checkbox" id="lotto5-option3" checked>
                            <label for="lotto5-option3">
                                <strong>Opsyon 3:</strong> N'importe fason 5 boul yo (ex: 14523, 13445, 12334, etc.)
                            </label>
                            <span class="option-multiplier">×25000</span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="lotto5-amount">Kantite pa opsyon</label>
                        <input type="number" id="lotto5-amount" placeholder="Kantite" min="1" value="1">
                        <small style="color: #7f8c8d;">Total = kantite × nimewo opsyon chwazi</small>
                    </div>
                    
                    <div class="bet-actions">
                        <button class="btn-primary" id="add-bet">Ajoute</button>
                        <button class="btn-secondary" id="return-to-types">Retounen</button>
                    </div>
                `;
                break;
                
            case 'grap':
                formHTML = `
                    <h3>${bet.name} - ${bet.description}</h3>
                    <p class="info-text"><small>Chwazi boule paire pou grap (3 chif menm)</small></p>
                    
                    <div style="margin-bottom: 15px;">
                        <div class="all-graps-btn" id="select-all-graps">
                            <i class="fas fa-check-square"></i> Chwazi Tout Graps
                        </div>
                        <div class="all-graps-btn" id="deselect-all-graps">
                            <i class="fas fa-times-circle"></i> Retire Tout Graps
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-bottom: 15px;" id="grap-selection-container">
                        <div class="pair-ball" data-pair="111">111</div>
                        <div class="pair-ball" data-pair="222">222</div>
                        <div class="pair-ball" data-pair="333">333</div>
                        <div class="pair-ball" data-pair="444">444</div>
                        <div class="pair-ball" data-pair="555">555</div>
                        <div class="pair-ball" data-pair="666">666</div>
                        <div class="pair-ball" data-pair="777">777</div>
                        <div class="pair-ball" data-pair="888">888</div>
                        <div class="pair-ball" data-pair="999">999</div>
                        <div class="pair-ball" data-pair="000">000</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="grap-amount">Kantite pou chak grap</label>
                        <input type="number" id="grap-amount" placeholder="Kantite" min="1" value="1">
                    </div>
                    
                    <div class="bet-actions">
                        <button class="btn-primary" id="add-selected-graps">Ajoute Graps Chwazi</button>
                        <button class="btn-secondary" id="return-to-types">Retounen</button>
                    </div>
                `;
                break;
        }
        
        betForm.innerHTML = formHTML;
        
        // Configurer le focus automatique
        setupAutoFocusInputs();
        
        // Configurer les événements
        if (gameType === 'grap') {
            setupGrapSelection();
        } else {
            // Pour les autres jeux
            const addButton = document.getElementById('add-bet');
            if (addButton) {
                addButton.addEventListener('click', function() {
                    addBet(gameType);
                });
            }
        }
        
        const returnButton = document.getElementById('return-to-types');
        if (returnButton) {
            returnButton.addEventListener('click', function() {
                document.getElementById('bet-form').style.display = 'none';
                document.getElementById('bet-type-nav').style.display = 'none';
                document.getElementById('auto-buttons').style.display = 'none';
                document.getElementById('games-interface').style.display = 'block';
            });
        }
        
        if (gameType === 'boulpe') {
            document.querySelectorAll('.n-ball[data-number]').forEach(ball => {
                ball.addEventListener('click', function() {
                    const number = this.getAttribute('data-number');
                    document.getElementById('boulpe-number').value = number;
                    document.getElementById('boulpe-amount').focus();
                });
            });
            
            document.getElementById('bo-all').addEventListener('click', function() {
                const amount = prompt("Kantite pou chak boule pe (00-99):", "1");
                if (amount && !isNaN(amount) && amount > 0) {
                    const numbers = ['00', '11', '22', '33', '44', '55', '66', '77', '88', '99'];
                    
                    activeBets.push({
                        type: gameType,
                        name: 'BOUL PE (Tout)',
                        number: '00-99',
                        amount: parseInt(amount) * numbers.length,
                        multiplier: bet.multiplier,
                        isGroup: true,
                        details: numbers.map(n => ({number: n, amount: parseInt(amount)}))
                    });
                    
                    updateBetsList();
                    showNotification(`${numbers.length} boule pe ajoute avèk siksè!`, "success");
                }
            });
        }
        
        if (gameType === 'borlette' || gameType === 'boulpe') {
            document.querySelectorAll('.n-ball[data-n]').forEach(ball => {
                ball.addEventListener('click', function() {
                    const n = this.getAttribute('data-n');
                    const numbers = [];
                    for (let i = 0; i <= 9; i++) {
                        numbers.push(i.toString() + n);
                    }
                    
                    const amount = prompt(`Kantite pou chak boule nan N${n}:`, "1");
                    if (amount && !isNaN(amount) && amount > 0) {
                        activeBets.push({
                            type: gameType,
                            name: `N${n} (Tout)`,
                            number: `0${n}-9${n}`,
                            amount: parseInt(amount) * numbers.length,
                            multiplier: bet.multiplier,
                            isGroup: true,
                            details: numbers.map(num => ({number: num, amount: parseInt(amount)}))
                        });
                        
                        updateBetsList();
                        showNotification(`${numbers.length} boule N${n} ajoute avèk siksè!`, "success");
                    }
                });
            });
        }
        
        // Focus automatique sur le premier champ
        const numberInput = betForm.querySelector('input[type="text"]');
        if (numberInput) {
            numberInput.focus();
        }
        
        document.getElementById('active-bets').style.display = 'block';
    }
    
    // Ajouter un pari
    function addBet(betType) {
        console.log("Ajouter pari:", betType);
        const bet = betTypes[betType];
        let number, amount;
        
        switch(betType) {
            case 'lotto3':
                number = document.getElementById('lotto3-number').value;
                amount = parseInt(document.getElementById('lotto3-amount').value);
                
                if (!/^\d{3}$/.test(number)) {
                    showNotification("Lotto 3 dwe gen 3 chif egzat (0-9)", "warning");
                    return;
                }
                break;
                
            case 'marriage':
                const num1 = document.getElementById('marriage-number1').value;
                const num2 = document.getElementById('marriage-number2').value;
                number = `${num1}*${num2}`;
                amount = parseInt(document.getElementById('marriage-amount').value);
                
                if (!/^\d{2}$/.test(num1) || !/^\d{2}$/.test(num2)) {
                    showNotification("Chak chif maryaj dwe gen 2 chif", "warning");
                    return;
                }
                break;
                
            case 'borlette':
                number = document.getElementById('borlette-number').value;
                amount = parseInt(document.getElementById('borlette-amount').value);
                
                if (!/^\d{2}$/.test(number)) {
                    showNotification("Borlette dwe gen 2 chif", "warning");
                    return;
                }
                break;
                
            case 'boulpe':
                number = document.getElementById('boulpe-number').value;
                amount = parseInt(document.getElementById('boulpe-amount').value);
                
                if (!/^\d{2}$/.test(number)) {
                    showNotification("Boul pe dwe gen 2 chif", "warning");
                    return;
                }
                
                if (number.length === 2 && number[0] === number[1]) {
                    // C'est une boule paire
                } else {
                    showNotification("Pou boul pe, fòk de chif yo menm! (ex: 00, 11, 22)", "warning");
                    return;
                }
                break;
                
            case 'lotto4':
                const num4_1 = document.getElementById('lotto4-number1').value;
                const num4_2 = document.getElementById('lotto4-number2').value;
                number = `${num4_1}${num4_2}`; // Concaténation simple pour 4 chiffres
                
                // Récupérer les options cochées
                const option1 = document.getElementById('lotto4-option1')?.checked || false;
                const option2 = document.getElementById('lotto4-option2')?.checked || false;
                const option3 = document.getElementById('lotto4-option3')?.checked || false;
                amount = parseInt(document.getElementById('lotto4-amount').value);
                
                if (!/^\d{2}$/.test(num4_1) || !/^\d{2}$/.test(num4_2)) {
                    showNotification("Chak boule Lotto 4 dwe gen 2 chif", "warning");
                    return;
                }
                
                // Calculer le montant total basé sur les options cochées
                const optionsCount = [option1, option2, option3].filter(opt => opt).length;
                if (optionsCount === 0) {
                    showNotification("Tanpri chwazi omwen yon opsyon", "warning");
                    return;
                }
                
                const totalAmount = amount * optionsCount;
                
                activeBets.push({
                    type: betType,
                    name: bet.name,
                    number: number,
                    amount: totalAmount,
                    multiplier: bet.multiplier,
                    options: {
                        option1: option1,
                        option2: option2,
                        option3: option3
                    },
                    perOptionAmount: amount,
                    isLotto4: true
                });
                
                updateBetsList();
                showNotification("Lotto 4 ajoute avèk siksè!", "success");
                
                // Retourner à la liste des jeux après un court délai
                setTimeout(() => {
                    document.getElementById('bet-form').style.display = 'none';
                    document.getElementById('bet-type-nav').style.display = 'none';
                    document.getElementById('auto-buttons').style.display = 'none';
                    document.getElementById('games-interface').style.display = 'block';
                }, 500);
                return; // Retourner pour éviter l'exécution du code général
                
            case 'lotto5':
                const num5_1 = document.getElementById('lotto5-number1').value;
                const num5_2 = document.getElementById('lotto5-number2').value;
                number = `${num5_1}${num5_2}`;
                
                // Récupérer les options cochées pour Lotto 5
                const lotto5Option1 = document.getElementById('lotto5-option1')?.checked || false;
                const lotto5Option2 = document.getElementById('lotto5-option2')?.checked || false;
                const lotto5Option3 = document.getElementById('lotto5-option3')?.checked || false;
                amount = parseInt(document.getElementById('lotto5-amount').value);
                
                if (!/^\d{3}$/.test(num5_1) || !/^\d{2}$/.test(num5_2)) {
                    showNotification("Lotto 5: Premye boule 3 chif, Dezyèm boule 2 chif", "warning");
                    return;
                }
                
                // Calculer le montant total basé sur les options cochées
                const lotto5OptionsCount = [lotto5Option1, lotto5Option2, lotto5Option3].filter(opt => opt).length;
                if (lotto5OptionsCount === 0) {
                    showNotification("Tanpri chwazi omwen yon opsyon", "warning");
                    return;
                }
                
                const lotto5TotalAmount = amount * lotto5OptionsCount;
                
                activeBets.push({
                    type: betType,
                    name: bet.name,
                    number: number,
                    amount: lotto5TotalAmount,
                    multiplier: bet.multiplier,
                    options: {
                        option1: lotto5Option1,
                        option2: lotto5Option2,
                        option3: lotto5Option3
                    },
                    perOptionAmount: amount,
                    isLotto5: true
                });
                
                updateBetsList();
                showNotification("Lotto 5 ajoute avèk siksè!", "success");
                
                // Retourner à la liste des jeux après un court délai
                setTimeout(() => {
                    document.getElementById('bet-form').style.display = 'none';
                    document.getElementById('bet-type-nav').style.display = 'none';
                    document.getElementById('auto-buttons').style.display = 'none';
                    document.getElementById('games-interface').style.display = 'block';
                }, 500);
                return; // Retourner pour éviter l'exécution du code général
        }
        
        if (!number || isNaN(amount) || amount <= 0) {
            showNotification("Tanpri rantre yon nimewo ak yon kantite valab", "warning");
            return;
        }
        
        activeBets.push({
            type: betType,
            name: bet.name,
            number: number,
            amount: amount,
            multiplier: bet.multiplier
        });
        
        updateBetsList();
        
        // Afficher la notification du total
        updateNormalBetTotalNotification();
        
        showNotification("Parye ajoute avèk siksè!", "success");
        
        // Retourner à la liste des jeux après un court délai
        setTimeout(() => {
            document.getElementById('bet-form').style.display = 'none';
            document.getElementById('bet-type-nav').style.display = 'none';
            document.getElementById('auto-buttons').style.display = 'none';
            document.getElementById('games-interface').style.display = 'block';
        }, 500);
    }
    
    // Mettre à jour la liste des paris
    function updateBetsList() {
        console.log("Mise à jour liste paris");
        const betsList = document.getElementById('bets-list');
        const betTotal = document.getElementById('bet-total');
        
        betsList.innerHTML = '';
        
        if (activeBets.length === 0) {
            betsList.innerHTML = '<p>Pa gen okenn parye aktif.</p>';
            betTotal.textContent = '0 goud';
            
            // Cacher la notification du total si aucun pari
            const notification = document.querySelector('.total-notification');
            if (notification) {
                notification.remove();
            }
            return;
        }
        
        const groupedBets = {};
        
        activeBets.forEach((bet, index) => {
            // Pour Lotto 4 et Lotto 5, on gère les options séparément
            if (bet.isLotto4 || bet.isLotto5) {
                const key = `${bet.type}_${bet.number}_${JSON.stringify(bet.options)}`;
                
                if (!groupedBets[key]) {
                    groupedBets[key] = {
                        bet: bet,
                        count: 1,
                        totalAmount: bet.amount,
                        indexes: [index]
                    };
                } else {
                    groupedBets[key].count++;
                    groupedBets[key].totalAmount += bet.amount;
                    groupedBets[key].indexes.push(index);
                }
            } else {
                const key = `${bet.type}_${bet.number}`;
                
                if (!groupedBets[key]) {
                    groupedBets[key] = {
                        bet: bet,
                        count: 1,
                        totalAmount: bet.amount,
                        indexes: [index]
                    };
                } else {
                    groupedBets[key].count++;
                    groupedBets[key].totalAmount += bet.amount;
                    groupedBets[key].indexes.push(index);
                }
            }
        });
        
        for (const key in groupedBets) {
            const group = groupedBets[key];
            const bet = group.bet;
            
            const betItem = document.createElement('div');
            betItem.className = 'bet-item';
            
            if (bet.isGroup) {
                betItem.innerHTML = `
                    <div class="bet-details">
                        <strong>${bet.name}</strong><br>
                        ${bet.number} (${bet.details.length} parye)
                    </div>
                    <div class="bet-amount">
                        ${group.totalAmount} goud
                        <span class="bet-remove" data-indexes="${group.indexes.join(',')}"><i class="fas fa-times"></i></span>
                    </div>
                `;
            } else if (bet.isLotto4 || bet.isLotto5) {
                let optionsText = '';
                if (bet.isLotto4) {
                    const options = [];
                    if (bet.options.option1) options.push('Opsyon 1');
                    if (bet.options.option2) options.push('Opsyon 2');
                    if (bet.options.option3) options.push('Opsyon 3');
                    optionsText = options.join(', ');
                } else if (bet.isLotto5) {
                    const options = [];
                    if (bet.options.option1) options.push('Opsyon 1');
                    if (bet.options.option2) options.push('Opsyon 2');
                    if (bet.options.option3) options.push('Opsyon 3');
                    optionsText = options.join(', ');
                }
                
                betItem.innerHTML = `
                    <div class="bet-details">
                        <strong>${bet.name}</strong><br>
                        ${bet.number}<br>
                        <small style="color: #7f8c8d;">${optionsText}</small>
                    </div>
                    <div class="bet-amount">
                        ${group.totalAmount} goud
                        <span class="bet-remove" data-indexes="${group.indexes.join(',')}"><i class="fas fa-times"></i></span>
                    </div>
                `;
            } else {
                betItem.innerHTML = `
                    <div class="bet-details">
                        <strong>${bet.name}</strong><br>
                        ${bet.number}
                    </div>
                    <div class="bet-amount">
                        ${group.totalAmount} goud
                        <span class="bet-remove" data-indexes="${group.indexes.join(',')}"><i class="fas fa-times"></i></span>
                    </div>
                `;
            }
            
            betsList.appendChild(betItem);
            
            // Ajouter l'événement pour supprimer
            const removeBtn = betItem.querySelector('.bet-remove');
            if (removeBtn) {
                removeBtn.addEventListener('click', function() {
                    const indexes = this.getAttribute('data-indexes').split(',').map(Number);
                    
                    indexes.sort((a, b) => b - a).forEach(index => {
                        activeBets.splice(index, 1);
                    });
                    
                    updateBetsList();
                });
            }
        }
        
        const total = activeBets.reduce((sum, bet) => sum + bet.amount, 0);
        betTotal.textContent = `${total} goud`;
        
        // Mettre à jour la notification du total
        updateNormalBetTotalNotification();
    }
    
    // Afficher le formulaire pour les jeux automatiques
    function showAutoGameForm(gameType) {
        console.log("Afficher formulaire jeu automatique:", gameType);
        const bet = betTypes[gameType];
        
        // Cacher l'interface des jeux
        document.getElementById('games-interface').style.display = 'none';
        document.getElementById('bet-type-nav').style.display = 'none';
        document.getElementById('auto-buttons').style.display = 'none';
        
        const betForm = document.getElementById('bet-form');
        betForm.style.display = 'block';
        
        // Réinitialiser les boules sélectionnées
        selectedBalls = [];
        
        let formHTML = '';
        
        if (gameType === 'auto-marriage') {
            formHTML = `
                <h3>${bet.name} - ${bet.description}</h3>
                <p class="info-text"><small>Chwazi plizyè boule (2 chif) pou maryaj otomatik</small></p>
                
                <div class="options-container">
                    <div style="margin-bottom: 15px;">
                        <div class="all-graps-btn" id="use-basket-balls">
                            <i class="fas fa-shopping-basket"></i> Itilize Boul nan Panye
                        </div>
                        <div class="all-graps-btn" id="enter-manual-balls">
                            <i class="fas fa-keyboard"></i> Antre Boul Manyèlman
                        </div>
                    </div>
                    
                    <div id="manual-balls-input" style="display: none;">
                        <div class="form-group">
                            <label for="manual-balls">Antre boul yo (separe pa espas):</label>
                            <input type="text" id="manual-balls" class="manual-balls-input" placeholder="12 34 56 78">
                            <small style="color: #7f8c8d;">Egzanp: 12 34 56 78 (4 boul 2 chif)</small>
                        </div>
                        <button class="btn-primary" id="process-manual-balls">
                            <i class="fas fa-check"></i> Proses Boul yo
                        </button>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <strong>Boules disponib:</strong>
                        <div class="balls-list" id="available-balls-list">
                            <!-- Les boules apparaîtront ici -->
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <div class="all-graps-btn" id="clear-balls-btn">
                            <i class="fas fa-times-circle"></i> Retire Tout Boul
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <strong>Boules sélectionnées:</strong>
                        <div id="selected-balls-list" style="min-height: 50px; border: 1px dashed #ccc; padding: 10px; margin-top: 5px; border-radius: 5px;">
                            Pa gen boul chwazi
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="auto-game-amount">Kantite pou chak maryaj</label>
                    <input type="number" id="auto-game-amount" placeholder="Kantite" min="1" value="1">
                </div>
                
                <div class="bet-actions">
                    <button class="btn-primary" id="add-auto-marriages">Ajoute Maryaj Otomatik</button>
                    <button class="btn-secondary" id="return-to-types">Retounen</button>
                </div>
            `;
        } else if (gameType === 'auto-lotto4') {
            formHTML = `
                <h3>${bet.name} - ${bet.description}</h3>
                <p class="info-text"><small>Chwazi plizyè boule (2 chif) pou Lotto 4 otomatik</small></p>
                
                <div class="options-container">
                    <div style="margin-bottom: 15px;">
                        <div class="all-graps-btn" id="use-basket-balls">
                            <i class="fas fa-shopping-basket"></i> Itilize Boul nan Panye
                        </div>
                        <div class="all-graps-btn" id="enter-manual-balls">
                            <i class="fas fa-keyboard"></i> Antre Boul Manyèlman
                        </div>
                    </div>
                    
                    <div id="manual-balls-input" style="display: none;">
                        <div class="form-group">
                            <label for="manual-balls">Antre boul yo (separe pa espas):</label>
                            <input type="text" id="manual-balls" class="manual-balls-input" placeholder="12 34 56 78">
                            <small style="color: #7f8c8d;">Egzanp: 12 34 56 78 (4 boul 2 chif)</small>
                        </div>
                        <button class="btn-primary" id="process-manual-balls">
                            <i class="fas fa-check"></i> Proses Boul yo
                        </button>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <strong>Boules disponib:</strong>
                        <div class="balls-list" id="available-balls-list">
                            <!-- Les boules apparaîtront ici -->
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <div class="all-graps-btn" id="clear-balls-btn">
                            <i class="fas fa-times-circle"></i> Retire Tout Boul
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <strong>Boules sélectionnées:</strong>
                        <div id="selected-balls-list" style="min-height: 50px; border: 1px dashed #ccc; padding: 10px; margin-top: 5px; border-radius: 5px;">
                            Pa gen boul chwazi
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <div class="option-group">
                            <label class="option-label">
                                <input type="checkbox" id="include-reverse" checked>
                                <span>Enkli renverse yo</span>
                            </label>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="auto-game-amount">Kantite pou chak Lotto 4</label>
                    <input type="number" id="auto-game-amount" placeholder="Kantite" min="1" value="1">
                </div>
                
                <div class="bet-actions">
                    <button class="btn-primary" id="add-auto-lotto4">Ajoute Lotto 4 Otomatik</button>
                    <button class="btn-secondary" id="return-to-types">Retounen</button>
                </div>
            `;
        }
        
        betForm.innerHTML = formHTML;
        
        // Configurer les événements
        document.getElementById('use-basket-balls').addEventListener('click', function() {
            loadBasketBalls();
        });
        
        document.getElementById('enter-manual-balls').addEventListener('click', function() {
            document.getElementById('manual-balls-input').style.display = 'block';
        });
        
        document.getElementById('process-manual-balls').addEventListener('click', function() {
            processManualBalls();
        });
        
        document.getElementById('clear-balls-btn').addEventListener('click', function() {
            selectedBalls = [];
            updateSelectedBallsList();
            updateAvailableBallsList();
        });
        
        if (gameType === 'auto-marriage') {
            document.getElementById('add-auto-marriages').addEventListener('click', function() {
                addAutoMarriages();
            });
        } else if (gameType === 'auto-lotto4') {
            document.getElementById('add-auto-lotto4').addEventListener('click', function() {
                addAutoLotto4();
            });
        }
        
        const returnButton = document.getElementById('return-to-types');
        if (returnButton) {
            returnButton.addEventListener('click', function() {
                document.getElementById('bet-form').style.display = 'none';
                document.getElementById('bet-type-nav').style.display = 'none';
                document.getElementById('auto-buttons').style.display = 'none';
                document.getElementById('games-interface').style.display = 'block';
            });
        }
        
        document.getElementById('active-bets').style.display = 'block';
    }
    
    // Charger les boules du panier
    function loadBasketBalls() {
        console.log("Chargement des boules du panier");
        
        // Récupérer toutes les boules borlette/boulpe du panier actif
        const basketBalls = [];
        
        activeBets.forEach(bet => {
            if (bet.type === 'borlette' || bet.type === 'boulpe') {
                if (bet.isGroup) {
                    // Pour les groupes, ajouter toutes les boules
                    bet.details.forEach(detail => {
                        if (/^\d{2}$/.test(detail.number)) {
                            basketBalls.push(detail.number);
                        }
                    });
                } else {
                    if (/^\d{2}$/.test(bet.number)) {
                        basketBalls.push(bet.number);
                    }
                }
            }
        });
        
        // Filtrer les doublons
        selectedBalls = [...new Set(basketBalls)];
        
        if (selectedBalls.length === 0) {
            showNotification("Pa gen boul borlette nan panye a", "warning");
            return;
        }
        
        updateSelectedBallsList();
        updateAvailableBallsList();
        
        showNotification(`${selectedBalls.length} boul chaje nan panye a`, "success");
    }
    
    // Traiter les boules manuelles
    function processManualBalls() {
        const manualInput = document.getElementById('manual-balls').value.trim();
        
        if (!manualInput) {
            showNotification("Tanpri antre kèk boul", "warning");
            return;
        }
        
        // Séparer par espaces
        const balls = manualInput.split(/\s+/);
        
        // Valider chaque boule
        const validBalls = [];
        const invalidBalls = [];
        
        balls.forEach(ball => {
            if (/^\d{2}$/.test(ball)) {
                validBalls.push(ball);
            } else {
                invalidBalls.push(ball);
            }
        });
        
        if (validBalls.length === 0) {
            showNotification("Pa gen boul valab. Boul yo dwe gen 2 chif.", "warning");
            return;
        }
        
        // Filtrer les doublons
        selectedBalls = [...new Set(validBalls)];
        
        updateSelectedBallsList();
        updateAvailableBallsList();
        
        let message = `${selectedBalls.length} boul valab ajoute`;
        if (invalidBalls.length > 0) {
            message += `. ${invalidBalls.length} boul envalid: ${invalidBalls.join(', ')}`;
        }
        
        showNotification(message, "success");
        
        // Cacher le champ manuel
        document.getElementById('manual-balls-input').style.display = 'none';
        document.getElementById('manual-balls').value = '';
    }
    
    // Mettre à jour la liste des boules disponibles
    function updateAvailableBallsList() {
        const ballsList = document.getElementById('available-balls-list');
        
        if (selectedBalls.length === 0) {
            ballsList.innerHTML = '<p>Pa gen boul disponib.</p>';
            return;
        }
        
        ballsList.innerHTML = '';
        
        selectedBalls.forEach((ball, index) => {
            const ballTag = document.createElement('div');
            ballTag.className = 'ball-tag';
            ballTag.innerHTML = `
                ${ball}
                <span class="remove-ball" onclick="removeBall(${index})">
                    <i class="fas fa-times"></i>
                </span>
            `;
            ballsList.appendChild(ballTag);
        });
    }
    
    // Retirer une boule
    window.removeBall = function(index) {
        selectedBalls.splice(index, 1);
        updateSelectedBallsList();
        updateAvailableBallsList();
    };
    
    // Mettre à jour la liste des boules sélectionnées
    function updateSelectedBallsList() {
        const ballsList = document.getElementById('selected-balls-list');
        
        if (selectedBalls.length === 0) {
            ballsList.innerHTML = "Pa gen boul chwazi";
            return;
        }
        
        ballsList.innerHTML = selectedBalls.join(', ');
    }
    
    // Ajouter des mariages automatiques
    function addAutoMarriages() {
        console.log("Ajouter mariages automatiques");
        const amount = parseInt(document.getElementById('auto-game-amount').value);
        
        if (selectedBalls.length < 2) {
            showNotification("Fò gen omwen 2 boul pou fè maryaj otomatik", "warning");
            return;
        }
        
        if (isNaN(amount) || amount <= 0) {
            showNotification("Tanpri antre yon kantite valab", "warning");
            return;
        }
        
        // Générer toutes les combinaisons possibles
        let addedCount = 0;
        
        for (let i = 0; i < selectedBalls.length; i++) {
            for (let j = i + 1; j < selectedBalls.length; j++) {
                const ball1 = selectedBalls[i];
                const ball2 = selectedBalls[j];
                
                activeBets.push({
                    type: 'marriage',
                    name: 'MARYAJ OTOMATIK',
                    number: `${ball1}*${ball2}`,
                    amount: amount,
                    multiplier: betTypes.marriage.multiplier,
                    isAuto: true
                });
                
                addedCount++;
            }
        }
        
        updateBetsList();
        showNotification(`${addedCount} maryaj otomatik ajoute avèk siksè!`, "success");
        
        // Retourner à la liste des jeux
        setTimeout(() => {
            document.getElementById('bet-form').style.display = 'none';
            document.getElementById('games-interface').style.display = 'block';
            selectedBalls = [];
        }, 500);
    }
    
    // Ajouter des Lotto 4 automatiques
    function addAutoLotto4() {
        console.log("Ajouter Lotto 4 automatiques");
        const amount = parseInt(document.getElementById('auto-game-amount').value);
        const includeReverse = document.getElementById('include-reverse').checked;
        
        if (selectedBalls.length < 2) {
            showNotification("Fò gen omwen 2 boul pou fè Lotto 4 otomatik", "warning");
            return;
        }
        
        if (isNaN(amount) || amount <= 0) {
            showNotification("Tanpri antre yon kantite valab", "warning");
            return;
        }
        
        // Générer toutes les combinaisons possibles
        let addedCount = 0;
        
        for (let i = 0; i < selectedBalls.length; i++) {
            for (let j = i + 1; j < selectedBalls.length; j++) {
                const ball1 = selectedBalls[i];
                const ball2 = selectedBalls[j];
                
                // Ajouter la combinaison normale
                activeBets.push({
                    type: 'lotto4',
                    name: 'LOTO 4 OTOMATIK',
                    number: ball1 + ball2, // Concaténation pour 4 chiffres
                    amount: amount,
                    multiplier: betTypes.lotto4.multiplier,
                    isAuto: true,
                    options: {
                        option1: false,
                        option2: false,
                        option3: true // Seulement l'option 3 pour automatique
                    },
                    perOptionAmount: amount
                });
                
                addedCount++;
                
                // Ajouter la version renversée si demandée
                if (includeReverse) {
                    activeBets.push({
                        type: 'lotto4',
                        name: 'LOTO 4 OTOMATIK (RENVÈSE)',
                        number: ball2 + ball1, // Version renversée
                        amount: amount,
                        multiplier: betTypes.lotto4.multiplier,
                        isAuto: true,
                        options: {
                            option1: false,
                            option2: false,
                            option3: true
                        },
                        perOptionAmount: amount
                    });
                    
                    addedCount++;
                }
            }
        }
        
        updateBetsList();
        showNotification(`${addedCount} Lotto 4 otomatik ajoute avèk siksè!`, "success");
        
        // Retourner à la liste des jeux
        setTimeout(() => {
            document.getElementById('bet-form').style.display = 'none';
            document.getElementById('games-interface').style.display = 'block';
            selectedBalls = [];
        }, 500);
    }
    
    // Charger les types de paris pour édition
    function loadBetTypesForEdit() {
        console.log("Charger types pari pour édition");
        const betTypeNav = document.getElementById('bet-type-nav');
        const autoButtons = document.getElementById('auto-buttons');
        const gamesInterface = document.getElementById('games-interface');
        
        // Pour l'édition, on utilise la navigation par catégories
        gamesInterface.style.display = 'none';
        betTypeNav.style.display = 'flex';
        autoButtons.style.display = 'flex';
        
        betTypeNav.innerHTML = '';
        
        // Catégories
        const categories = [
            { id: 'borlette', name: 'BORLETTE' },
            { id: 'lotto', name: 'LOTTO' },
            { id: 'special', name: 'ESPECIAL' }
        ];
        
        categories.forEach(category => {
            const navItem = document.createElement('div');
            navItem.className = 'bet-type-nav-item';
            if (category.id === 'borlette') {
                navItem.classList.add('active');
            }
            navItem.textContent = category.name;
            navItem.setAttribute('data-category', category.id);
            
            navItem.addEventListener('click', function() {
                document.querySelectorAll('.bet-type-nav-item').forEach(item => {
                    item.classList.remove('active');
                });
                this.classList.add('active');
                showGameCategoryEdit(category.id);
            });
            
            betTypeNav.appendChild(navItem);
        });
        
        // Configurer les boutons automatiques
        setupAutoButtons();
        
        // Afficher la première catégorie
        showGameCategoryEdit('borlette');
    }
    
    // Afficher une catégorie de jeu pour édition
    function showGameCategoryEdit(categoryId) {
        console.log("Afficher catégorie pour édition:", categoryId);
        // Cacher toutes les catégories
        document.querySelectorAll('.game-category').forEach(cat => {
            cat.style.display = 'none';
        });
        
        // Afficher la catégorie sélectionnée
        const categoryElement = document.getElementById(`${categoryId}-category`);
        if (categoryElement) {
            categoryElement.style.display = 'block';
        }
        
        currentBetCategory = categoryId;
        
        // Configurer les événements
        setupGameSelection();
    }
    
    // Configurer les boutons automatiques
    function setupAutoButtons() {
        const autoMarriageBtn = document.getElementById('auto-marriage-btn');
        const autoLotto4Btn = document.getElementById('auto-lotto4-btn');
        const reverseLotto4Btn = document.getElementById('reverse-lotto4-btn');
        
        if (autoMarriageBtn) {
            autoMarriageBtn.addEventListener('click', generateAutoMarriages);
        }
        
        if (autoLotto4Btn) {
            autoLotto4Btn.addEventListener('click', generateAutoLotto4);
        }
        
        if (reverseLotto4Btn) {
            reverseLotto4Btn.addEventListener('click', reverseLotto4Combinations);
        }
    }
    
    // Générer les mariages automatiques
    function generateAutoMarriages() {
        console.log("Générer mariages automatiques");
        // Récupérer toutes les boules borlette/boulpe jouées
        const borletteBalls = activeBets.filter(bet => 
            (bet.type === 'borlette' || bet.type === 'boulpe') && 
            !bet.isGroup && 
            bet.number.length === 2
        ).map(bet => bet.number);
        
        if (borletteBalls.length < 2) {
            showNotification("Fò gen omwen 2 boule borlette pou fè maryaj otomatik", "warning");
            return;
        }
        
        const amount = prompt("Kantite pou chak maryaj:", "1");
        if (!amount || isNaN(amount) || amount <= 0) {
            return;
        }
        
        // Générer toutes les combinaisons possibles
        for (let i = 0; i < borletteBalls.length; i++) {
            for (let j = i + 1; j < borletteBalls.length; j++) {
                const ball1 = borletteBalls[i];
                const ball2 = borletteBalls[j];
                
                activeBets.push({
                    type: 'marriage',
                    name: 'MARYAJ',
                    number: `${ball1}*${ball2}`,
                    amount: parseInt(amount),
                    multiplier: betTypes.marriage.multiplier
                });
            }
        }
        
        updateBetsList();
        showNotification(`${borletteBalls.length * (borletteBalls.length - 1) / 2} maryaj otomatik ajoute!`, "success");
    }
    
    // Générer les Lotto 4 automatiques
    function generateAutoLotto4() {
        console.log("Générer Lotto 4 automatiques");
        // Récupérer toutes les boules borlette/boulpe jouées
        const borletteBalls = activeBets.filter(bet => 
            (bet.type === 'borlette' || bet.type === 'boulpe') && 
            !bet.isGroup && 
            bet.number.length === 2
        ).map(bet => bet.number);
        
        if (borletteBalls.length < 2) {
            showNotification("Fò gen omwen 2 boul pou fè Lotto 4 otomatik", "warning");
            return;
        }
        
        const amount = prompt("Kantite pou chak Lotto 4:", "1");
        if (!amount || isNaN(amount) || amount <= 0) {
            return;
        }
        
        // Générer toutes les combinaisons possibles de 2 boules
        for (let i = 0; i < borletteBalls.length; i++) {
            for (let j = i + 1; j < borletteBalls.length; j++) {
                const ball1 = borletteBalls[i];
                const ball2 = borletteBalls[j];
                
                activeBets.push({
                    type: 'lotto4',
                    name: 'LOTO 4',
                    number: `${ball1}*${ball2}`,
                    amount: parseInt(amount),
                    multiplier: betTypes.lotto4.multiplier
                });
            }
        }
        
        updateBetsList();
        showNotification(`${borletteBalls.length * (borletteBalls.length - 1) / 2} Lotto 4 otomatik ajoute!`, "success");
    }
    
    // Renverser les combinaisons Lotto 4
    function reverseLotto4Combinations() {
        console.log("Renverser Lotto 4");
        // Récupérer tous les Lotto 4 existants
        const lotto4Bets = activeBets.filter(bet => bet.type === 'lotto4' && !bet.isAuto);
        
        if (lotto4Bets.length === 0) {
            showNotification("Pa gen Lotto 4 pou renverse", "warning");
            return;
        }
        
        const amount = prompt("Kantite pou chak Lotto 4 renverse:", "1");
        if (!amount || isNaN(amount) || amount <= 0) {
            return;
        }
        
        // Pour chaque Lotto 4, créer la version renversée
        lotto4Bets.forEach(bet => {
            // Extraire les boules (format: "1234" pour 4 chiffres)
            if (bet.number.length === 4) {
                const ball1 = bet.number.substring(0, 2);
                const ball2 = bet.number.substring(2, 4);
                
                // Renverser: 1234 devient 3412
                const reversedNumber = ball2 + ball1;
                
                // Copier les options du pari original
                activeBets.push({
                    type: 'lotto4',
                    name: 'LOTO 4 (RENVÈSE)',
                    number: reversedNumber,
                    amount: parseInt(amount),
                    multiplier: betTypes.lotto4.multiplier,
                    options: bet.options || { option1: true, option2: true, option3: true },
                    perOptionAmount: parseInt(amount)
                });
            }
        });
        
        updateBetsList();
        showNotification(`${lotto4Bets.length} Lotto 4 renverse ajoute!`, "success");
    }
    
    // Sauvegarder les paris dans l'historique
    function saveBetsToHistory() {
        let history = JSON.parse(localStorage.getItem('novaLottoHistory')) || [];
        
        const record = {
            id: Date.now(),
            date: new Date().toLocaleString(),
            draw: currentDraw,
            drawTime: currentDrawTime,
            bets: [...activeBets],
            total: activeBets.reduce((sum, bet) => sum + bet.amount, 0)
        };
        
        history.push(record);
        
        localStorage.setItem('novaLottoHistory', JSON.stringify(history));
    }
    
    // Les autres fonctions restent inchangées mais adaptées pour l'API
    // (setupAutoFocusInputs, setupGrapSelection, addSelectedGraps, etc.)
    
    // Fonction pour vérifier les nouveaux résultats
    async function checkForNewResults() {
        console.log("Vérification des nouveaux résultats...");
        
        if (!isOnline) {
            console.log("Pas de connexion Internet");
            return;
        }
        
        try {
            await loadResultsFromAPI();
            showNotification("Résultats mis à jour", "success");
        } catch (error) {
            console.error("Erreur lors de la vérification des résultats:", error);
        }
    }
    
    // Fonction pour sauvegarder un ticket
    async function saveTicket() {
        console.log("Sauvegarder fiche");
        if (activeBets.length === 0) {
            showNotification("Pa gen okenn parye pou sove nan fiche a", "warning");
            return;
        }
        
        const ticket = {
            id: Date.now().toString(),
            number: ticketNumber,
            date: new Date().toISOString(),
            draw: currentDraw,
            drawTime: currentDrawTime,
            bets: [...activeBets],
            total: activeBets.reduce((sum, bet) => sum + bet.amount, 0),
            agentName: currentAdmin ? currentAdmin.name : 'Agent',
            agentId: currentAdmin ? currentAdmin.id : 1
        };
        
        try {
            // Envoyer à l'API
            const data = await apiFetch(APP_CONFIG.bets, {
                method: 'POST',
                body: JSON.stringify(ticket)
            });
            
            // Sauvegarder localement aussi
            savedTickets.push(ticket);
            localStorage.setItem('novaLottoTickets', JSON.stringify(savedTickets));
            localStorage.setItem('novaLottoTicketNumber', (ticketNumber + 1).toString());
            
            showNotification("Fiche sove avèk siksè!", "success");
            ticketNumber++;
            activeBets = [];
            updateBetsList();
            
        } catch (error) {
            console.error('Erreur sauvegarde fiche:', error);
            // En cas d'erreur, sauvegarder localement (mode hors ligne)
            savedTickets.push(ticket);
            localStorage.setItem('novaLottoTickets', JSON.stringify(savedTickets));
            localStorage.setItem('novaLottoTicketNumber', (ticketNumber + 1).toString());
            pendingSyncTickets.push(ticket);
            localStorage.setItem('novaLottoPendingSync', JSON.stringify(pendingSyncTickets));
            
            showNotification("Fiche sove lokalman. Ap tann pou synchronize...", "success");
            ticketNumber++;
            activeBets = [];
            updateBetsList();
        }
    }
    
    // Fonction pour générer un rapport
    async function generateEndOfDrawReport() {
        console.log("Génération du rapport...");
        
        try {
            const data = await apiFetch(APP_CONFIG.reports);
            
            const reportScreen = document.getElementById('report-screen');
            const reportContent = document.getElementById('report-content');
            
            reportContent.innerHTML = `
                <div class="report-header">
                    <h3>${companyInfo.reportTitle}</h3>
                    <p>Rapò Fin Tiraj</p>
                    <p>${new Date().toLocaleString()}</p>
                </div>
                <div class="report-details">
                    ${data.reportHtml || '<p>Rapport généré avec succès</p>'}
                </div>
                <p style="margin-top: 20px; text-align: center;">
                    <strong>Tel:</strong> ${companyInfo.reportPhone}<br>
                    <strong>Adrès:</strong> ${companyInfo.address}
                </p>
            `;
            
            document.querySelector('.container').style.display = 'none';
            reportScreen.style.display = 'block';
            
        } catch (error) {
            console.error("Erreur génération rapport:", error);
            showNotification("Erreur génération rapport", "error");
        }
    }
    
    // Les autres fonctions utilitaires
    function setupAutoFocusInputs() {
        document.querySelectorAll('input[type="text"]').forEach(input => {
            input.addEventListener('input', function(e) {
                const maxLength = parseInt(this.getAttribute('maxlength'));
                if (maxLength && this.value.length >= maxLength) {
                    // Trouver le prochain champ
                    const allInputs = Array.from(document.querySelectorAll('input[type="text"], input[type="number"]'));
                    const currentIndex = allInputs.indexOf(this);
                    if (currentIndex < allInputs.length - 1) {
                        allInputs[currentIndex + 1].focus();
                    }
                }
            });
            
            // Permettre la navigation avec les flèches
            input.addEventListener('keydown', function(e) {
                const allInputs = Array.from(document.querySelectorAll('input[type="text"], input[type="number"]'));
                const currentIndex = allInputs.indexOf(this);
                
                if (e.key === 'ArrowRight' && currentIndex < allInputs.length - 1) {
                    e.preventDefault();
                    allInputs[currentIndex + 1].focus();
                } else if (e.key === 'ArrowLeft' && currentIndex > 0) {
                    e.preventDefault();
                    allInputs[currentIndex - 1].focus();
                } else if (e.key === 'Enter') {
                    e.preventDefault();
                    if (currentIndex < allInputs.length - 1) {
                        allInputs[currentIndex + 1].focus();
                    } else {
                        // Si c'est le dernier champ, simuler un clic sur le bouton d'ajout
                        const addButton = document.getElementById('add-bet');
                        if (addButton) addButton.click();
                    }
                }
            });
        });
    }
    
    function setupGrapSelection() {
        console.log("Configuration sélection graps");
        const grapBalls = document.querySelectorAll('#grap-selection-container .pair-ball');
        let selectedGraps = new Set();
        
        // Sélectionner/désélectionner un grap
        grapBalls.forEach(ball => {
            ball.addEventListener('click', function() {
                this.classList.toggle('selected');
                const pair = this.getAttribute('data-pair');
                
                if (this.classList.contains('selected')) {
                    selectedGraps.add(pair);
                } else {
                    selectedGraps.delete(pair);
                }
                console.log("Grap sélectionné:", pair, Array.from(selectedGraps));
            });
        });
        
        // Sélectionner tous les graps
        document.getElementById('select-all-graps').addEventListener('click', function() {
            grapBalls.forEach(ball => {
                ball.classList.add('selected');
                const pair = ball.getAttribute('data-pair');
                selectedGraps.add(pair);
            });
            console.log("Tous graps sélectionnés");
        });
        
        // Désélectionner tous les graps
        document.getElementById('deselect-all-graps').addEventListener('click', function() {
            grapBalls.forEach(ball => {
                ball.classList.remove('selected');
                const pair = ball.getAttribute('data-pair');
                selectedGraps.delete(pair);
            });
            console.log("Tous graps désélectionnés");
        });
        
        // Ajouter les graps sélectionnés
        document.getElementById('add-selected-graps').addEventListener('click', function() {
            addSelectedGraps(selectedGraps);
        });
    }
    
    function addSelectedGraps(selectedGraps) {
        console.log("Ajouter graps:", Array.from(selectedGraps));
        const amount = parseInt(document.getElementById('grap-amount').value);
        const selectedBalls = document.querySelectorAll('#grap-selection-container .pair-ball.selected');
        
        if (selectedBalls.length === 0) {
            showNotification("Tanpri chwazi omwen yon grap", "warning");
            return;
        }
        
        if (isNaN(amount) || amount <= 0) {
            showNotification("Tanpri antre yon kantite valab", "warning");
            return;
        }
        
        let addedCount = 0;
        
        selectedBalls.forEach(ball => {
            const pair = ball.getAttribute('data-pair');
            
            activeBets.push({
                type: 'grap',
                name: 'GRAP',
                number: pair,
                amount: amount,
                multiplier: betTypes.grap.multiplier
            });
            
            addedCount++;
            
            // Désélectionner après ajout
            ball.classList.remove('selected');
            selectedGraps.delete(pair);
        });
        
        updateBetsList();
        showNotification(`${addedCount} graps ajoute avèk siksè!`, "success");
        
        // Réinitialiser le formulaire
        document.getElementById('grap-amount').value = '1';
    }
    
    // Fermer l'écran de pari
    function closeBettingScreen() {
        console.log("Fermer écran pari");
        const bettingScreen = document.getElementById('betting-screen');
        bettingScreen.classList.remove('slide-in');
        bettingScreen.classList.add('slide-out');
        
        setTimeout(() => {
            bettingScreen.style.display = 'none';
            document.querySelector('.container').style.display = 'block';
        }, 300);
    }
    
    // Soumettre les paris
    function submitBets() {
        console.log("Soumettre les paris");
        if (activeBets.length === 0) {
            showNotification("Pa gen okenn parye pou konfime", "warning");
            return;
        }
        
        saveBetsToHistory();
        checkConnectionBeforeSavePrint();
    }
    
    // Vérifier la connexion avant sauvegarde/impression
    function checkConnectionBeforeSavePrint() {
        console.log("Vérification connexion avant sauvegarde/impression");
        // Pour le moment, on sauvegarde directement
        saveTicket();
    }
    
    // Vérifier la connexion avant impression
    function checkConnectionBeforePrint() {
        console.log("Vérification connexion avant impression");
        printTicket();
    }
    
    // Annuler l'impression
    function cancelPrint() {
        console.log("Impression annulée");
        document.getElementById('connection-check').style.display = 'none';
        document.querySelector('.container').style.display = 'block';
    }
    
    // Réessayer la connexion
    function retryConnectionCheck() {
        console.log("Réessayer connexion");
        // Implémenter la logique de réessai ici
        showNotification("Ap tcheke koneksyon ankò...", "info");
    }
    
    // Imprimer le ticket
    function printTicket() {
        console.log("Impression du ticket");
        const printContent = document.getElementById('tickets-screen').innerHTML;
        const originalContent = document.body.innerHTML;
        
        document.body.innerHTML = printContent;
        window.print();
        document.body.innerHTML = originalContent;
        
        // Réinitialiser les événements
        document.addEventListener('DOMContentLoaded', function() {
            // Réinitialiser les écouteurs d'événements
        });
    }
    
    // Basculer le panneau multi-tirages
    function toggleMultiDrawPanel() {
        console.log("Basculer panneau multi-tirages");
        const content = document.getElementById('multi-draw-content');
        const toggleIcon = document.getElementById('multi-draw-toggle').querySelector('i');
        
        content.classList.toggle('expanded');
        
        if (content.classList.contains('expanded')) {
            toggleIcon.className = 'fas fa-chevron-up';
        } else {
            toggleIcon.className = 'fas fa-chevron-down';
        }
    }
    
    // Initialiser le panneau multi-tirages
    function initMultiDrawPanel() {
        console.log("Initialiser panneau multi-tirages");
        
        // Ajouter les options de tirage
        const optionsContainer = document.getElementById('multi-draw-options');
        optionsContainer.innerHTML = '';
        
        Object.keys(draws).forEach(drawId => {
            const draw = draws[drawId];
            const option = document.createElement('div');
            option.className = 'multi-draw-option';
            option.textContent = draw.name;
            option.setAttribute('data-draw', drawId);
            
            option.addEventListener('click', function() {
                this.classList.toggle('selected');
                const drawId = this.getAttribute('data-draw');
                
                if (this.classList.contains('selected')) {
                    selectedMultiDraws.add(drawId);
                } else {
                    selectedMultiDraws.delete(drawId);
                }
                
                console.log("Tirages sélectionnés:", Array.from(selectedMultiDraws));
            });
            
            optionsContainer.appendChild(option);
        });
        
        // Ajouter les jeux
        const gameSelect = document.getElementById('multi-game-select');
        gameSelect.innerHTML = '';
        
        const games = [
            { id: 'borlette', name: 'BORLETTE' },
            { id: 'lotto3', name: 'LOTO 3' },
            { id: 'lotto4', name: 'LOTO 4' },
            { id: 'lotto5', name: 'LOTO 5' }
        ];
        
        games.forEach(game => {
            const option = document.createElement('div');
            option.className = 'multi-game-option';
            if (game.id === 'borlette') {
                option.classList.add('selected');
            }
            option.textContent = game.name;
            option.setAttribute('data-game', game.id);
            
            option.addEventListener('click', function() {
                document.querySelectorAll('.multi-game-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                this.classList.add('selected');
                selectedMultiGame = game.id;
                updateMultiGameForm();
            });
            
            gameSelect.appendChild(option);
        });
        
        // Mettre à jour le formulaire
        updateMultiGameForm();
    }
    
    // Mettre à jour le formulaire multi-jeu
    function updateMultiGameForm() {
        console.log("Mettre à jour formulaire multi-jeu:", selectedMultiGame);
        const numberInputs = document.getElementById('multi-number-inputs');
        
        let html = '';
        
        switch(selectedMultiGame) {
            case 'borlette':
                html = `
                    <label for="multi-number">2 Chif yo</label>
                    <input type="text" id="multi-number" placeholder="00" maxlength="2" pattern="[0-9]{2}">
                `;
                break;
            case 'lotto3':
                html = `
                    <label for="multi-number">3 Chif yo</label>
                    <input type="text" id="multi-number" placeholder="000" maxlength="3" pattern="[0-9]{3}">
                `;
                break;
            case 'lotto4':
                html = `
                    <label>4 Chif yo</label>
                    <div class="number-inputs">
                        <input type="text" id="multi-number1" placeholder="00" maxlength="2" pattern="[0-9]{2}">
                        <input type="text" id="multi-number2" placeholder="00" maxlength="2" pattern="[0-9]{2}">
                    </div>
                `;
                break;
            case 'lotto5':
                html = `
                    <label>5 Chif yo</label>
                    <div class="number-inputs">
                        <input type="text" id="multi-number1" placeholder="000" maxlength="3" pattern="[0-9]{3}">
                        <input type="text" id="multi-number2" placeholder="00" maxlength="2" pattern="[0-9]{2}">
                    </div>
                `;
                break;
        }
        
        numberInputs.innerHTML = html;
    }
    
    // Ajouter à la fiche multi-tirages
    function addToMultiDrawTicket() {
        console.log("Ajouter à fiche multi-tirages");
        
        if (selectedMultiDraws.size === 0) {
            showNotification("Tanpri chwazi omwen yon tiraj", "warning");
            return;
        }
        
        let number, amount;
        amount = parseInt(document.getElementById('multi-draw-amount').value);
        
        switch(selectedMultiGame) {
            case 'borlette':
                number = document.getElementById('multi-number').value;
                if (!/^\d{2}$/.test(number)) {
                    showNotification("Borlette dwe gen 2 chif", "warning");
                    return;
                }
                break;
            case 'lotto3':
                number = document.getElementById('multi-number').value;
                if (!/^\d{3}$/.test(number)) {
                    showNotification("Lotto 3 dwe gen 3 chif", "warning");
                    return;
                }
                break;
            case 'lotto4':
                const num1 = document.getElementById('multi-number1').value;
                const num2 = document.getElementById('multi-number2').value;
                number = num1 + num2;
                if (!/^\d{2}$/.test(num1) || !/^\d{2}$/.test(num2)) {
                    showNotification("Lotto 4: chak boule dwe gen 2 chif", "warning");
                    return;
                }
                break;
            case 'lotto5':
                const num5_1 = document.getElementById('multi-number1').value;
                const num5_2 = document.getElementById('multi-number2').value;
                number = num5_1 + num5_2;
                if (!/^\d{3}$/.test(num5_1) || !/^\d{2}$/.test(num5_2)) {
                    showNotification("Lotto 5: premye 3 chif, dezyèm 2 chif", "warning");
                    return;
                }
                break;
        }
        
        if (isNaN(amount) || amount <= 0) {
            showNotification("Tanpri antre yon kantite valab", "warning");
            return;
        }
        
        // Ajouter le pari pour chaque tiraj sélectionné
        selectedMultiDraws.forEach(drawId => {
            currentMultiDrawTicket.bets.push({
                type: selectedMultiGame,
                name: betTypes[selectedMultiGame].name,
                number: number,
                amount: amount,
                multiplier: betTypes[selectedMultiGame].multiplier,
                draw: drawId,
                drawTime: 'morning' // Par défaut
            });
            
            currentMultiDrawTicket.draws.add(drawId);
        });
        
        // Mettre à jour le total
        currentMultiDrawTicket.totalAmount += amount * selectedMultiDraws.size;
        
        // Mettre à jour l'affichage
        updateCurrentMultiDrawTicketInfo();
        
        showNotification(`${selectedMultiDraws.size} parye ajoute nan fiche multi-tirages!`, "success");
        
        // Afficher le panneau d'information
        document.getElementById('current-multi-ticket-info').style.display = 'block';
    }
    
    // Mettre à jour l'info de la fiche multi-tirages actuelle
    function updateCurrentMultiDrawTicketInfo() {
        console.log("Mettre à jour info fiche multi-tirages");
        const summary = document.getElementById('multi-ticket-summary');
        
        if (currentMultiDrawTicket.bets.length === 0) {
            summary.innerHTML = '<p>Pa gen okenn parye nan fiche a.</p>';
            return;
        }
        
        let html = `<p><strong>${currentMultiDrawTicket.bets.length}</strong> parye</p>`;
        html += `<p><strong>${currentMultiDrawTicket.draws.size}</strong> tiraj diferan</p>`;
        html += `<p><strong>Total: ${currentMultiDrawTicket.totalAmount} goud</strong></p>`;
        
        summary.innerHTML = html;
    }
    
    // Voir la fiche multi-tirages actuelle
    function viewCurrentMultiDrawTicket() {
        console.log("Voir fiche multi-tirages actuelle");
        if (currentMultiDrawTicket.bets.length === 0) {
            showNotification("Pa gen okenn parye nan fiche multi-tirages", "warning");
            return;
        }
        
        // Afficher un aperçu
        let message = `Fiche Multi-Tirages:\n`;
        message += `Total: ${currentMultiDrawTicket.totalAmount} goud\n`;
        message += `Parye: ${currentMultiDrawTicket.bets.length}\n`;
        message += `Tirages: ${Array.from(currentMultiDrawTicket.draws).map(d => draws[d].name).join(', ')}`;
        
        alert(message);
    }
    
    // Sauvegarder et imprimer la fiche multi-tirages
    function saveAndPrintMultiDrawTicket() {
        console.log("Sauvegarder et imprimer fiche multi-tirages");
        
        if (currentMultiDrawTicket.bets.length === 0) {
            showNotification("Pa gen okenn parye nan fiche multi-tirages", "warning");
            return;
        }
        
        // Créer un ticket complet
        const ticket = {
            id: currentMultiDrawTicket.id,
            number: ticketNumber,
            date: new Date().toISOString(),
            isMultiDraw: true,
            bets: [...currentMultiDrawTicket.bets],
            total: currentMultiDrawTicket.totalAmount,
            draws: Array.from(currentMultiDrawTicket.draws),
            agentName: currentAdmin ? currentAdmin.name : 'Agent'
        };
        
        // Sauvegarder
        savedTickets.push(ticket);
        localStorage.setItem('novaLottoTickets', JSON.stringify(savedTickets));
        localStorage.setItem('novaLottoTicketNumber', (ticketNumber + 1).toString());
        
        // Ajouter aux fiches multi-tirages
        multiDrawTickets.push(ticket);
        
        // Réinitialiser la fiche actuelle
        currentMultiDrawTicket = {
            id: Date.now().toString(),
            bets: [],
            totalAmount: 0,
            draws: new Set(),
            createdAt: new Date().toISOString()
        };
        
        // Mettre à jour l'affichage
        updateCurrentMultiDrawTicketInfo();
        document.getElementById('current-multi-ticket-info').style.display = 'none';
        
        showNotification("Fiche multi-tirages sove avèk siksè!", "success");
        ticketNumber++;
    }
    
    // Ouvrir l'écran des fiches multi-tirages
    function openMultiTicketsScreen() {
        console.log("Ouvrir écran fiches multi-tirages");
        document.querySelector('.container').style.display = 'none';
        document.getElementById('multi-tickets-screen').style.display = 'block';
        
        displayMultiTickets();
    }
    
    // Afficher les fiches multi-tirages
    function displayMultiTickets() {
        console.log("Afficher fiches multi-tirages");
        const container = document.getElementById('multi-tickets-list');
        
        if (multiDrawTickets.length === 0) {
            container.innerHTML = `
                <div style="text-align: center; padding: 20px; color: #7f8c8d;">
                    <i class="fas fa-info-circle" style="font-size: 2rem; margin-bottom: 10px;"></i>
                    <p>Pa gen okenn fiche multi-tirages.</p>
                </div>
            `;
            return;
        }
        
        container.innerHTML = '';
        
        multiDrawTickets.forEach(ticket => {
            const ticketDiv = document.createElement('div');
            ticketDiv.className = 'multi-ticket-item';
            
            const drawsList = ticket.draws.map(d => draws[d]?.name || d).join(', ');
            
            ticketDiv.innerHTML = `
                <div style="margin-bottom: 10px;">
                    <strong>Fiche #${String(ticket.number).padStart(6, '0')}</strong>
                    <div style="font-size: 0.9rem; color: #7f8c8d;">
                        ${new Date(ticket.date).toLocaleString()}
                    </div>
                </div>
                <div style="margin-bottom: 5px;">
                    <strong>Tirages:</strong> ${drawsList}
                </div>
                <div style="margin-bottom: 5px;">
                    <strong>Parye:</strong> ${ticket.bets.length}
                </div>
                <div class="bet-total">
                    <span>Total:</span>
                    <span>${ticket.total} goud</span>
                </div>
            `;
            
            container.appendChild(ticketDiv);
        });
    }
    
    // Afficher un écran
    function showScreen(screen) {
        console.log("Afficher écran:", screen);
        
        // Cacher tous les écrans
        document.querySelectorAll('.screen').forEach(s => {
            s.style.display = 'none';
        });
        
        document.getElementById('betting-screen').style.display = 'none';
        document.getElementById('report-screen').style.display = 'none';
        document.getElementById('results-check-screen').style.display = 'none';
        document.getElementById('multi-tickets-screen').style.display = 'none';
        
        // Afficher l'écran demandé
        if (screen === 'home') {
            document.querySelector('.container').style.display = 'block';
        } else {
            document.querySelector('.container').style.display = 'none';
            document.getElementById(`${screen}-screen`).style.display = 'block';
        }
        
        // Mettre à jour la navigation
        document.querySelectorAll('.nav-item').forEach(item => {
            item.classList.remove('active');
            if (item.getAttribute('data-screen') === screen) {
                item.classList.add('active');
            }
        });
    }
    
    // Rechercher un ticket
    function searchTicket() {
        console.log("Rechercher ticket");
        const searchTerm = document.getElementById('search-ticket-number').value.trim();
        
        if (!searchTerm) {
            showNotification("Tanpri antre yon nimewo fiche", "warning");
            return;
        }
        
        // Rechercher dans les tickets sauvegardés
        const results = savedTickets.filter(ticket => 
            ticket.number.toString().includes(searchTerm) ||
            ticket.id.includes(searchTerm)
        );
        
        displayTicketSearchResults(results);
    }
    
    // Afficher les résultats de recherche de tickets
    function displayTicketSearchResults(results) {
        console.log("Afficher résultats recherche tickets:", results.length);
        const container = document.getElementById('ticket-management-list');
        
        if (results.length === 0) {
            container.innerHTML = `
                <div style="text-align: center; padding: 20px; color: #7f8c8d;">
                    <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 10px;"></i>
                    <p>Pa gen fiche ki koresponn ak rechèch la.</p>
                </div>
            `;
            return;
        }
        
        container.innerHTML = '';
        
        results.forEach(ticket => {
            const ticketDiv = document.createElement('div');
            ticketDiv.className = 'ticket-management';
            
            ticketDiv.innerHTML = `
                <div class="ticket-management-header">
                    <div>
                        <strong>Fiche #${String(ticket.number).padStart(6, '0')}</strong>
                        <div style="font-size: 0.9rem; color: #7f8c8d;">
                            ${new Date(ticket.date).toLocaleString()}
                        </div>
                    </div>
                    <div class="ticket-actions-buttons">
                        <button class="edit-btn" onclick="viewTicketDetails('${ticket.id}')">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                <div class="ticket-details" id="details-${ticket.id}" style="display: none;">
                    <!-- Les détails seront chargés ici -->
                </div>
            `;
            
            container.appendChild(ticketDiv);
        });
    }
    
    // Voir les détails d'un ticket
    window.viewTicketDetails = function(ticketId) {
        console.log("Voir détails ticket:", ticketId);
        const detailsDiv = document.getElementById(`details-${ticketId}`);
        const ticket = savedTickets.find(t => t.id === ticketId);
        
        if (!ticket) return;
        
        if (detailsDiv.style.display === 'none') {
            let betsHTML = '';
            ticket.bets.forEach(bet => {
                betsHTML += `
                    <div class="bet-summary">
                        <div class="bet-type">${bet.name}</div>
                        <div class="bet-numbers">${bet.number}</div>
                        <div class="bet-amount-summary">${bet.amount} G</div>
                    </div>
                `;
            });
            
            detailsDiv.innerHTML = `
                <div style="margin-bottom: 10px;">
                    <strong>Tiraj:</strong> ${draws[ticket.draw]?.name || ticket.draw} (${ticket.drawTime === 'morning' ? 'Maten' : 'Swè'})
                </div>
                <div style="margin-bottom: 10px;">
                    <strong>Parye:</strong>
                    <div style="margin-top: 5px;">
                        ${betsHTML}
                    </div>
                </div>
                <div class="bet-total">
                    <span>Total:</span>
                    <span>${ticket.total} G</span>
                </div>
            `;
            
            detailsDiv.style.display = 'block';
        } else {
            detailsDiv.style.display = 'none';
        }
    };
    
    // Afficher tous les tickets
    function showAllTickets() {
        console.log("Afficher tous les tickets");
        displayTicketSearchResults(savedTickets);
    }
    
    // Afficher les tickets en attente
    function showPendingTickets() {
        console.log("Afficher tickets en attente");
        displayTicketSearchResults(pendingSyncTickets);
    }
    
    // Rechercher dans l'historique
    function searchHistory() {
        console.log("Rechercher historique");
        const searchTerm = document.getElementById('search-history').value.trim();
        
        if (!searchTerm) {
            showNotification("Tanpri antre yon tèm rechèch", "warning");
            return;
        }
        
        // Charger l'historique
        const history = JSON.parse(localStorage.getItem('novaLottoHistory')) || [];
        
        // Filtrer les résultats
        const results = history.filter(record => 
            record.draw.includes(searchTerm) ||
            record.date.includes(searchTerm) ||
            record.bets.some(bet => 
                bet.name.includes(searchTerm) ||
                bet.number.includes(searchTerm)
            )
        );
        
        displayHistoryResults(results);
    }
    
    // Afficher les résultats de l'historique
    function displayHistoryResults(results) {
        console.log("Afficher résultats historique:", results.length);
        const container = document.getElementById('history-list');
        
        if (results.length === 0) {
            container.innerHTML = `
                <div style="text-align: center; padding: 20px; color: #7f8c8d;">
                    <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 10px;"></i>
                    <p>Pa gen rezilta ki koresponn ak rechèch la.</p>
                </div>
            `;
            return;
        }
        
        container.innerHTML = '';
        
        results.forEach(record => {
            const historyDiv = document.createElement('div');
            historyDiv.className = 'history-item';
            
            let betsHTML = '';
            record.bets.forEach(bet => {
                betsHTML += `
                    <div class="history-bet">
                        <span>${bet.name}: ${bet.number}</span>
                        <span>${bet.amount} G</span>
                    </div>
                `;
            });
            
            historyDiv.innerHTML = `
                <div class="history-header">
                    <div class="history-draw">${draws[record.draw]?.name || record.draw} (${record.drawTime === 'morning' ? 'Maten' : 'Swè'})</div>
                    <div class="history-date">${record.date}</div>
                </div>
                <div class="history-bets">
                    ${betsHTML}
                </div>
                <div class="history-total">
                    <span>Total:</span>
                    <span>${record.total} G</span>
                </div>
            `;
            
            container.appendChild(historyDiv);
        });
    }
    
    // Rechercher des fiches gagnantes
    function searchWinningTickets() {
        console.log("Rechercher fiches gagnantes");
        const searchTerm = document.getElementById('search-winning-tickets').value.trim();
        
        if (!searchTerm) {
            showNotification("Tanpri antre yon tèm rechèch", "warning");
            return;
        }
        
        // Filtrer les fiches gagnantes
        const results = winningTickets.filter(ticket => 
            ticket.number.toString().includes(searchTerm) ||
            ticket.draw.includes(searchTerm) ||
            ticket.winningBets.some(bet => 
                bet.name.includes(searchTerm) ||
                bet.number.includes(searchTerm)
            )
        );
        
        displayWinningTicketResults(results);
    }
    
    // Afficher les résultats des fiches gagnantes
    function displayWinningTicketResults(results) {
        console.log("Afficher résultats fiches gagnantes:", results.length);
        const container = document.getElementById('winning-tickets-list');
        
        if (results.length === 0) {
            container.innerHTML = `
                <div style="text-align: center; padding: 20px; color: #7f8c8d;">
                    <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 10px;"></i>
                    <p>Pa gen fiche genyen ki koresponn ak rechèch la.</p>
                </div>
            `;
            return;
        }
        
        container.innerHTML = '';
        
        results.forEach(ticket => {
            const ticketDiv = document.createElement('div');
            ticketDiv.className = 'winning-ticket';
            
            let betsHTML = '';
            ticket.winningBets.forEach(bet => {
                betsHTML += `
                    <div class="bet-item">
                        <div class="bet-details">
                            <strong>${bet.name}</strong><br>
                            ${bet.number} (${bet.winType})
                        </div>
                        <div class="bet-amount">
                            <span class="winning-amount">+${bet.winAmount} G</span>
                        </div>
                    </div>
                `;
            });
            
            ticketDiv.innerHTML = `
                <div style="margin-bottom: 10px;">
                    <strong>Fiche #${String(ticket.number).padStart(6, '0')}</strong>
                    <div style="font-size: 0.9rem; color: #7f8c8d;">
                        ${draws[ticket.draw].name} (${ticket.drawTime === 'morning' ? 'Maten' : 'Swè'})
                    </div>
                </div>
                <div style="margin-bottom: 10px;">
                    <strong>Rezilta:</strong> ${ticket.result.lot1} | ${ticket.result.lot2} | ${ticket.result.lot3}
                </div>
                ${betsHTML}
                <div class="bet-total">
                    <span>Total Gains:</span>
                    <span class="winning-amount">${ticket.totalWinnings} G</span>
                </div>
            `;
            
            container.appendChild(ticketDiv);
        });
    }
    
    // Mettre à jour le badge des fiches en attente
    function updatePendingBadge() {
        console.log("Mettre à jour badge fiches en attente");
        const pendingCount = pendingSyncTickets.length;
        
        // Mettre à jour l'indicateur de synchronisation
        const syncStatus = document.getElementById('sync-status');
        const syncText = document.getElementById('sync-text');
        
        if (pendingCount > 0) {
            syncStatus.className = 'sync-status sync-pending';
            syncText.textContent = `${pendingCount} fiche pou sync`;
        } else if (isOnline) {
            syncStatus.className = 'sync-status sync-connected';
            syncText.textContent = 'Konekte';
        } else {
            syncStatus.className = 'sync-status sync-disconnected';
            syncText.textContent = 'Pa Konekte';
        }
    }
    
    // Charger le logo
    function loadLogo() {
        console.log("Charger logo");
        // Vérifier si le logo existe
        const logo = new Image();
        logo.onload = function() {
            console.log("Logo chargé avec succès");
        };
        logo.onerror = function() {
            console.log("Logo non trouvé, utilisation du logo par défaut");
            // Utiliser un logo par défaut si nécessaire
        };
        logo.src = companyLogo;
    }
    
    // Mettre à jour la notification du total pour paris normaux
    function updateNormalBetTotalNotification() {
        const total = activeBets.reduce((sum, bet) => sum + bet.amount, 0);
        
        if (total === 0) {
            // Supprimer la notification si elle existe
            const existingNotification = document.querySelector('.total-notification');
            if (existingNotification) {
                existingNotification.remove();
            }
            return;
        }
        
        // Créer ou mettre à jour la notification
        let notification = document.querySelector('.total-notification');
        if (!notification) {
            notification = document.createElement('div');
            notification.className = 'total-notification';
            document.getElementById('total-notification-container').appendChild(notification);
        }
        
        notification.innerHTML = `
            <i class="fas fa-coins"></i>
            <span>Total Aktuèl:</span>
            <span class="total-amount">${total} goud</span>
        `;
    }
    
    // Les fonctions manquantes sont maintenant définies
    </script>
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/service-worker.js')
                .then(reg => console.log('Service Worker enregistré', reg))
                .catch(err => console.log('Échec d’enregistrement', err));
        }
    </script>
</body>
</html>