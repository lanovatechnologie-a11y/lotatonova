<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lotato - Master Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #8b5cf6;
            --secondary-color: #1e293b;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --dark-color: #0f172a;
            --light-color: #f1f5f9;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f8fafc;
            color: var(--dark-color);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Header */
        .header {
            background: linear-gradient(135deg, var(--dark-color), var(--secondary-color));
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #8b5cf6, #ec4899);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }
        
        .logo-text h1 {
            font-size: 1.8rem;
            margin-bottom: 5px;
        }
        
        .logo-text p {
            color: #cbd5e1;
            font-size: 0.9rem;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .user-avatar {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, #f59e0b, #ec4899);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .header-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
        }
        
        .stat-card {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #cbd5e1;
        }
        
        /* Main Content */
        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 30px;
        }
        
        /* Sidebar */
        .sidebar {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            height: fit-content;
        }
        
        .nav-title {
            color: var(--secondary-color);
            font-size: 1rem;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e2e8f0;
        }
        
        .nav-menu {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 15px;
            background: #f8fafc;
            border-radius: 8px;
            color: #64748b;
            text-decoration: none;
            transition: all 0.3s;
            border-left: 4px solid transparent;
        }
        
        .nav-item:hover {
            background: #e2e8f0;
            color: var(--secondary-color);
        }
        
        .nav-item.active {
            background: #ede9fe;
            color: var(--primary-color);
            border-left-color: var(--primary-color);
        }
        
        /* Content Area */
        .content-area {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }
        
        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f1f5f9;
        }
        
        .content-title {
            font-size: 1.5rem;
            color: var(--secondary-color);
        }
        
        /* Buttons */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background: #7c3aed;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: var(--success-color);
            color: white;
        }
        
        .btn-danger {
            background: var(--danger-color);
            color: white;
        }
        
        .btn-warning {
            background: var(--warning-color);
            color: white;
        }
        
        /* Table */
        .table-container {
            overflow-x: auto;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
        }
        
        .table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }
        
        .table thead {
            background: #f8fafc;
        }
        
        .table th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: var(--secondary-color);
            border-bottom: 2px solid #e2e8f0;
        }
        
        .table td {
            padding: 15px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .table tr:hover {
            background: #f8fafc;
        }
        
        /* Status Badges */
        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
        }
        
        .status-active {
            background: #d1fae5;
            color: #065f46;
        }
        
        .status-inactive {
            background: #fee2e2;
            color: #991b1b;
        }
        
        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 8px;
        }
        
        .action-btn {
            width: 35px;
            height: 35px;
            border-radius: 6px;
            border: none;
            background: #f1f5f9;
            color: #64748b;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .action-btn:hover {
            transform: translateY(-2px);
        }
        
        .action-btn.view:hover {
            background: var(--primary-color);
            color: white;
        }
        
        .action-btn.edit:hover {
            background: var(--warning-color);
            color: white;
        }
        
        .action-btn.delete:hover {
            background: var(--danger-color);
            color: white;
        }
        
        /* Modals */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: white;
            border-radius: 15px;
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-header {
            padding: 20px;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title {
            font-size: 1.3rem;
            color: var(--secondary-color);
            font-weight: 600;
        }
        
        .modal-body {
            padding: 20px;
        }
        
        .modal-footer {
            padding: 20px;
            border-top: 1px solid #e2e8f0;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        /* Forms */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--secondary-color);
        }
        
        .form-control {
            width: 100%;
            padding: 12px;
            border: 1px solid #cbd5e1;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        /* Multipliers Grid */
        .multipliers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .multiplier-item {
            background: #f8fafc;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }
        
        .multiplier-name {
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--secondary-color);
        }
        
        /* Games Grid */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        
        .game-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: #f8fafc;
            border-radius: 8px;
        }
        
        /* Loading */
        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
            color: #64748b;
        }
        
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid #f1f5f9;
            border-top: 3px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 2px solid #e2e8f0;
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 12px 25px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            font-weight: 600;
            color: #64748b;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .tab:hover {
            color: var(--secondary-color);
        }
        
        .tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Cards */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            border: 1px solid #e2e8f0;
        }
        
        .card-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .card-logo {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary-color), #ec4899);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }
        
        .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--secondary-color);
        }
        
        .card-subtitle {
            font-size: 0.9rem;
            color: #64748b;
        }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                display: none;
            }
        }
        
        @media (max-width: 768px) {
            .header-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .multipliers-grid,
            .games-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 480px) {
            .multipliers-grid,
            .games-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-top">
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-crown"></i>
                    </div>
                    <div class="logo-text">
                        <h1>Lotato Master</h1>
                        <p>Administration Syst√®me Principal</p>
                    </div>
                </div>
                
                <div class="user-info">
                    <div class="user-avatar" id="user-avatar">M</div>
                    <div>
                        <div style="font-weight: bold;" id="user-name">Administrateur Master</div>
                        <div style="font-size: 0.9rem; color: #cbd5e1;">Niveau: Master</div>
                    </div>
                    <button class="btn btn-danger" id="logout-btn">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>
            
            <div class="header-stats">
                <div class="stat-card">
                    <div class="stat-value" id="total-subsystems">0</div>
                    <div class="stat-label">Sous-Syst√®mes</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="active-subsystems">0</div>
                    <div class="stat-label">Actifs</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="total-agents">0</div>
                    <div class="stat-label">Agents Totaux</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="monthly-revenue">0 HTG</div>
                    <div class="stat-label">Revenu Mensuel</div>
                </div>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <!-- Sidebar -->
            <div class="sidebar">
                <div class="nav-title">Navigation</div>
                <div class="nav-menu">
                    <a href="#" class="nav-item active" data-tab="dashboard">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Tableau de bord</span>
                    </a>
                    <a href="#" class="nav-item" data-tab="subsystems">
                        <i class="fas fa-building"></i>
                        <span>Sous-Syst√®mes</span>
                    </a>
                    <a href="#" class="nav-item" data-tab="reports">
                        <i class="fas fa-chart-bar"></i>
                        <span>Rapports</span>
                    </a>
                    <a href="#" class="nav-item" data-tab="settings">
                        <i class="fas fa-cog"></i>
                        <span>Param√®tres Syst√®me</span>
                    </a>
                    <a href="#" class="nav-item" data-tab="activity">
                        <i class="fas fa-history"></i>
                        <span>Journal d'activit√©</span>
                    </a>
                </div>
            </div>
            
            <!-- Content Area -->
            <div class="content-area">
                <!-- Dashboard Tab -->
                <div id="dashboard-tab" class="tab-content active">
                    <div class="content-header">
                        <div class="content-title">
                            <i class="fas fa-tachometer-alt"></i>
                            Tableau de bord Master
                        </div>
                        <button class="btn btn-primary" id="refresh-dashboard">
                            <i class="fas fa-sync-alt"></i> Actualiser
                        </button>
                    </div>
                    
                    <div class="cards-grid">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-logo" style="background: linear-gradient(135deg, #8b5cf6, #ec4899);">
                                    <i class="fas fa-plus-circle"></i>
                                </div>
                                <div>
                                    <div class="card-title">Nouveau Sous-Syst√®me</div>
                                    <div class="card-subtitle">Cr√©er un nouvel espace</div>
                                </div>
                            </div>
                            <p style="color: #64748b; margin-bottom: 20px;">
                                Configurez un nouveau sous-syst√®me avec ses propres param√®tres.
                            </p>
                            <button class="btn btn-primary" id="create-subsystem-btn" style="width: 100%;">
                                <i class="fas fa-plus"></i> Cr√©er un Sous-Syst√®me
                            </button>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <div class="card-logo" style="background: linear-gradient(135deg, #10b981, #0ea5e9);">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                                <div>
                                    <div class="card-title">Performances</div>
                                    <div class="card-subtitle">Vue d'ensemble</div>
                                </div>
                            </div>
                            <div style="margin-top: 15px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                    <span>Taux d'activit√©</span>
                                    <span id="activity-rate">85%</span>
                                </div>
                                <div style="height: 8px; background: #e2e8f0; border-radius: 4px; overflow: hidden;">
                                    <div style="width: 85%; height: 100%; background: linear-gradient(90deg, #10b981, #0ea5e9);"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <div class="card-logo" style="background: linear-gradient(135deg, #f59e0b, #f97316);">
                                    <i class="fas fa-exclamation-triangle"></i>
                                </div>
                                <div>
                                    <div class="card-title">Alertes</div>
                                    <div class="card-subtitle">√Ä surveiller</div>
                                </div>
                            </div>
                            <div id="alerts-list" style="margin-top: 15px;">
                                <div style="padding: 10px; background: #fef3c7; border-radius: 6px; margin-bottom: 10px;">
                                    <div style="font-weight: 600; color: #92400e;">Abonnement expire bient√¥t</div>
                                    <div style="font-size: 0.9rem; color: #92400e;">2 sous-syst√®mes</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Recent Activity -->
                    <div style="margin-top: 30px;">
                        <h3 style="color: var(--secondary-color); margin-bottom: 20px;">
                            <i class="fas fa-history"></i> Activit√© R√©cente
                        </h3>
                        <div class="table-container">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>Date/Heure</th>
                                        <th>Sous-Syst√®me</th>
                                        <th>Action</th>
                                        <th>D√©tails</th>
                                    </tr>
                                </thead>
                                <tbody id="recent-activity">
                                    <!-- Dynamically filled -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Subsystems Tab -->
                <div id="subsystems-tab" class="tab-content">
                    <div class="content-header">
                        <div class="content-title">
                            <i class="fas fa-building"></i>
                            Gestion des Sous-Syst√®mes
                        </div>
                        <button class="btn btn-primary" id="add-subsystem-btn">
                            <i class="fas fa-plus"></i> Ajouter un Sous-Syst√®me
                        </button>
                    </div>
                    
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Nom</th>
                                    <th>Domaine</th>
                                    <th>Statut</th>
                                    <th>Propri√©taire</th>
                                    <th>Agents</th>
                                    <th>Cr√©√© le</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="subsystems-list">
                                <!-- Dynamically filled -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="loading" id="subsystems-loading">
                        <div class="loading-spinner"></div>
                        <p>Chargement des sous-syst√®mes...</p>
                    </div>
                </div>
                
                <!-- Settings Tab -->
                <div id="settings-tab" class="tab-content">
                    <div class="content-header">
                        <div class="content-title">
                            <i class="fas fa-cog"></i>
                            Param√®tres du Syst√®me
                        </div>
                    </div>
                    
                    <div class="tabs">
                        <button class="tab active" data-settings-tab="general">G√©n√©ral</button>
                        <button class="tab" data-settings-tab="security">S√©curit√©</button>
                        <button class="tab" data-settings-tab="backup">Sauvegarde</button>
                    </div>
                    
                    <div class="tab-content active" id="general-settings">
                        <div class="form-group">
                            <label class="form-label">Nom du Syst√®me</label>
                            <input type="text" class="form-control" id="system-name" value="Lotato Master System">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">URL du Syst√®me</label>
                            <input type="text" class="form-control" id="system-url" value="https://lotato-master.com">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Devise par d√©faut</label>
                            <select class="form-control" id="default-currency">
                                <option value="HTG">Gourde Ha√Øtienne (HTG)</option>
                                <option value="USD">Dollar US (USD)</option>
                                <option value="EUR">Euro (EUR)</option>
                            </select>
                        </div>
                        
                        <button class="btn btn-success">
                            <i class="fas fa-save"></i> Sauvegarder les param√®tres
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal: Create Subsystem -->
    <div class="modal" id="create-subsystem-modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Cr√©er un Nouveau Sous-Syst√®me</div>
                <button class="modal-close" id="close-create-modal">&times;</button>
            </div>
            
            <div class="modal-body">
                <form id="create-subsystem-form">
                    <div class="form-group">
                        <label class="form-label">Nom du Sous-Syst√®me *</label>
                        <input type="text" class="form-control" id="subsystem-name" placeholder="Ex: Borlette Cap-Ha√Øtien" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Sous-domaine *</label>
                        <div style="display: flex; align-items: center; gap: 5px;">
                            <input type="text" class="form-control" id="subsystem-domain" placeholder="Ex: caphaitien" required style="flex: 1;">
                            <span>.novalotto.com</span>
                        </div>
                        <small style="color: #64748b; display: block; margin-top: 5px;">
                            L'URL sera: https://[sous-domaine].novalotto.com
                        </small>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Propri√©taire *</label>
                            <input type="text" class="form-control" id="subsystem-owner" placeholder="Nom complet du propri√©taire" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Email du propri√©taire *</label>
                            <input type="email" class="form-control" id="subsystem-email" placeholder="proprietaire@email.com" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Identifiant d'acc√®s *</label>
                        <input type="text" class="form-control" id="subsystem-username" placeholder="Identifiant pour connexion" required>
                        <small style="color: #64748b; display: block; margin-top: 5px;">
                            Cet identifiant sera utilis√© pour se connecter au sous-syst√®me
                        </small>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Mot de passe temporaire *</label>
                        <input type="text" class="form-control" id="subsystem-password" value="Lotato2024!" required>
                        <small style="color: #64748b; display: block; margin-top: 5px;">
                            Le propri√©taire devra changer ce mot de passe √† la premi√®re connexion
                        </small>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Logo (URL)</label>
                        <input type="text" class="form-control" id="subsystem-logo" placeholder="https://exemple.com/logo.png">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Limites du sous-syst√®me</label>
                        <div class="form-row">
                            <div class="form-group">
                                <label style="font-size: 0.9rem; color: #64748b;">Nombre max d'agents</label>
                                <input type="number" class="form-control" id="max-agents" value="50" min="1">
                            </div>
                            <div class="form-group">
                                <label style="font-size: 0.9rem; color: #64748b;">Nombre max de superviseurs</label>
                                <input type="number" class="form-control" id="max-supervisors" value="10" min="1">
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Jeux autoris√©s</label>
                        <div class="games-grid">
                            <div class="game-item">
                                <input type="checkbox" id="game-borlette" checked>
                                <label for="game-borlette">Borlette (2 chiffres)</label>
                            </div>
                            <div class="game-item">
                                <input type="checkbox" id="game-boulpe" checked>
                                <label for="game-boulpe">Boul Pe</label>
                            </div>
                            <div class="game-item">
                                <input type="checkbox" id="game-lotto3" checked>
                                <label for="game-lotto3">Lotto 3</label>
                            </div>
                            <div class="game-item">
                                <input type="checkbox" id="game-lotto4" checked>
                                <label for="game-lotto4">Lotto 4</label>
                            </div>
                            <div class="game-item">
                                <input type="checkbox" id="game-lotto5" checked>
                                <label for="game-lotto5">Lotto 5</label>
                            </div>
                            <div class="game-item">
                                <input type="checkbox" id="game-grap" checked>
                                <label for="game-grap">Grap</label>
                            </div>
                            <div class="game-item">
                                <input type="checkbox" id="game-marriage" checked>
                                <label for="game-marriage">Marriage</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Multiplicateurs par d√©faut</label>
                        <div class="multipliers-grid">
                            <div class="multiplier-item">
                                <div class="multiplier-name">Borlette</div>
                                <input type="number" class="form-control" id="multiplier-borlette" value="60" min="1">
                            </div>
                            <div class="multiplier-item">
                                <div class="multiplier-name">Boul Pe</div>
                                <input type="number" class="form-control" id="multiplier-boulpe" value="60" min="1">
                            </div>
                            <div class="multiplier-item">
                                <div class="multiplier-name">Lotto 3</div>
                                <input type="number" class="form-control" id="multiplier-lotto3" value="500" min="1">
                            </div>
                            <div class="multiplier-item">
                                <div class="multiplier-name">Lotto 4</div>
                                <input type="number" class="form-control" id="multiplier-lotto4" value="5000" min="1">
                            </div>
                            <div class="multiplier-item">
                                <div class="multiplier-name">Lotto 5</div>
                                <input type="number" class="form-control" id="multiplier-lotto5" value="25000" min="1">
                            </div>
                            <div class="multiplier-item">
                                <div class="multiplier-name">Grap</div>
                                <input type="number" class="form-control" id="multiplier-grap" value="500" min="1">
                            </div>
                            <div class="multiplier-item">
                                <div class="multiplier-name">Marriage</div>
                                <input type="number" class="form-control" id="multiplier-marriage" value="1000" min="1">
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">
                            <input type="checkbox" id="subsystem-active" checked>
                            Activer imm√©diatement le sous-syst√®me
                        </label>
                    </div>
                    
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" id="cancel-create">Annuler</button>
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-plus"></i> Cr√©er le Sous-Syst√®me
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Modal: Edit Subsystem -->
    <div class="modal" id="edit-subsystem-modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Modifier le Sous-Syst√®me</div>
                <button class="modal-close" id="close-edit-modal">&times;</button>
            </div>
            
            <div class="modal-body">
                <form id="edit-subsystem-form">
                    <!-- Will be filled dynamically -->
                </form>
            </div>
        </div>
    </div>
    
    <script>
        // Configuration
        const API_BASE_URL = 'https://lotatonova-fv0b.onrender.com';
        const APP_CONFIG = {
            login: `${API_BASE_URL}/api/auth/login`,
            verify: `${API_BASE_URL}/api/auth/verify`,
            subsystems: `${API_BASE_URL}/api/master/subsystems`
        };
        
        let authToken = localStorage.getItem('nova_token');
        let currentUser = JSON.parse(localStorage.getItem('nova_user') || '{}');
        
        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üëë Master Dashboard initialis√©');
            
            // V√©rifier l'authentification
            checkAuth();
            
            // Configurer les √©v√©nements
            setupEventListeners();
            
            // Charger les donn√©es initiales
            loadDashboardData();
            loadSubsystems();
        });
        
        // V√©rifier l'authentification
        async function checkAuth() {
            if (!authToken) {
                window.location.href = '/index.html';
                return;
            }
            
            try {
                const response = await fetch(APP_CONFIG.verify, {
                    headers: { 'Authorization': `Bearer ${authToken}` }
                });
                
                const data = await response.json();
                
                if (!data.success || data.user.role !== 'master') {
                    window.location.href = '/index.html';
                    return;
                }
                
                // Mettre √† jour l'interface utilisateur
                document.getElementById('user-avatar').textContent = 
                    data.user.username?.charAt(0) || 'M';
                document.getElementById('user-name').textContent = 
                    data.user.username || 'Administrateur Master';
                
                // Stocker l'utilisateur
                currentUser = data.user;
                localStorage.setItem('nova_user', JSON.stringify(data.user));
                
            } catch (error) {
                console.error('Erreur v√©rification auth:', error);
                window.location.href = '/index.html';
            }
        }
        
        // Configurer les √©v√©nements
        function setupEventListeners() {
            // Navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Mettre √† jour la navigation active
                    document.querySelectorAll('.nav-item').forEach(nav => {
                        nav.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // Afficher l'onglet correspondant
                    const tab = this.getAttribute('data-tab');
                    showTab(tab);
                });
            });
            
            // Tabs settings
            document.querySelectorAll('[data-settings-tab]').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-settings-tab');
                    showSettingsTab(tabId);
                });
            });
            
            // Boutons
            document.getElementById('logout-btn').addEventListener('click', logout);
            document.getElementById('refresh-dashboard').addEventListener('click', refreshDashboard);
            document.getElementById('create-subsystem-btn').addEventListener('click', showCreateModal);
            document.getElementById('add-subsystem-btn').addEventListener('click', showCreateModal);
            
            // Modals cr√©ation
            document.getElementById('close-create-modal').addEventListener('click', hideCreateModal);
            document.getElementById('cancel-create').addEventListener('click', hideCreateModal);
            
            // Formulaire cr√©ation
            document.getElementById('create-subsystem-form').addEventListener('submit', createSubsystem);
        }
        
        // Afficher un onglet
        function showTab(tabId) {
            // Cacher tous les onglets
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Afficher l'onglet demand√©
            const tab = document.getElementById(`${tabId}-tab`);
            if (tab) {
                tab.classList.add('active');
            }
        }
        
        // Afficher un onglet de param√®tres
        function showSettingsTab(tabId) {
            // Mettre √† jour les tabs
            document.querySelectorAll('[data-settings-tab]').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`[data-settings-tab="${tabId}"]`).classList.add('active');
            
            // Afficher le contenu
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`${tabId}-settings`).classList.add('active');
        }
        
        // Charger les donn√©es du tableau de bord
        async function loadDashboardData() {
            try {
                // Pour l'instant, on simule des donn√©es
                const stats = {
                    totalSubsystems: 12,
                    activeSubsystems: 10,
                    totalAgents: 245,
                    monthlyRevenue: 1250000
                };
                
                document.getElementById('total-subsystems').textContent = stats.totalSubsystems;
                document.getElementById('active-subsystems').textContent = stats.activeSubsystems;
                document.getElementById('total-agents').textContent = stats.totalAgents;
                document.getElementById('monthly-revenue').textContent = 
                    stats.monthlyRevenue.toLocaleString() + ' HTG';
                
                // Charger l'activit√© r√©cente
                loadRecentActivity();
                
            } catch (error) {
                console.error('Erreur chargement dashboard:', error);
            }
        }
        
        // Charger l'activit√© r√©cente
        async function loadRecentActivity() {
            try {
                const activities = [
                    {
                        datetime: new Date().toLocaleString('fr-FR'),
                        subsystem: 'Borlette Cap-Ha√Øtien',
                        action: 'Cr√©ation',
                        details: 'Nouveau superviseur ajout√©'
                    },
                    {
                        datetime: new Date(Date.now() - 3600000).toLocaleString('fr-FR'),
                        subsystem: 'Lotto Port-au-Prince',
                        action: 'Modification',
                        details: 'Multiplicateurs mis √† jour'
                    },
                    {
                        datetime: new Date(Date.now() - 7200000).toLocaleString('fr-FR'),
                        subsystem: 'Borlette Gona√Øves',
                        action: 'Transaction',
                        details: 'Ticket vendu - 5000 HTG'
                    }
                ];
                
                const tbody = document.getElementById('recent-activity');
                tbody.innerHTML = '';
                
                activities.forEach(activity => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${activity.datetime}</td>
                        <td><strong>${activity.subsystem}</strong></td>
                        <td>${activity.action}</td>
                        <td>${activity.details}</td>
                    `;
                    tbody.appendChild(row);
                });
                
            } catch (error) {
                console.error('Erreur chargement activit√©:', error);
            }
        }
        
        // Charger les sous-syst√®mes
        async function loadSubsystems() {
            const loading = document.getElementById('subsystems-loading');
            const tbody = document.getElementById('subsystems-list');
            
            loading.style.display = 'flex';
            tbody.innerHTML = '';
            
            try {
                // Dans une version compl√®te, on appellerait l'API
                setTimeout(() => {
                    const subsystems = [
                        {
                            id: '1',
                            name: 'Borlette Cap-Ha√Øtien',
                            domain: 'caphaitien',
                            status: 'active',
                            owner: 'Jean Dupont',
                            agents: 25,
                            created_at: '2024-01-15'
                        },
                        {
                            id: '2',
                            name: 'Lotto Port-au-Prince',
                            domain: 'pap',
                            status: 'active',
                            owner: 'Marie Laurent',
                            agents: 42,
                            created_at: '2024-01-10'
                        },
                        {
                            id: '3',
                            name: 'Borlette Gona√Øves',
                            domain: 'gonaives',
                            status: 'inactive',
                            owner: 'Pierre Charles',
                            agents: 18,
                            created_at: '2024-01-05'
                        }
                    ];
                    
                    subsystems.forEach(subsystem => {
                        const row = document.createElement('tr');
                        const statusClass = subsystem.status === 'active' ? 'status-active' : 'status-inactive';
                        const statusText = subsystem.status === 'active' ? 'Actif' : 'Inactif';
                        
                        row.innerHTML = `
                            <td>
                                <strong>${subsystem.name}</strong>
                                <div style="font-size: 0.9rem; color: #64748b;">${subsystem.domain}.novalotto.com</div>
                            </td>
                            <td>${subsystem.domain}.novalotto.com</td>
                            <td>
                                <span class="status-badge ${statusClass}">${statusText}</span>
                            </td>
                            <td>${subsystem.owner}</td>
                            <td>
                                <div style="text-align: center; font-weight: bold;">${subsystem.agents}</div>
                            </td>
                            <td>${new Date(subsystem.created_at).toLocaleDateString('fr-FR')}</td>
                            <td>
                                <div class="action-buttons">
                                    <button class="action-btn view" onclick="viewSubsystem('${subsystem.id}')" title="Voir">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="action-btn edit" onclick="editSubsystem('${subsystem.id}')" title="Modifier">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="action-btn delete" onclick="deleteSubsystem('${subsystem.id}')" title="Supprimer">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </td>
                        `;
                        tbody.appendChild(row);
                    });
                    
                    loading.style.display = 'none';
                    
                }, 1000);
                
            } catch (error) {
                console.error('Erreur chargement sous-syst√®mes:', error);
                loading.style.display = 'none';
            }
        }
        
        // Afficher le modal de cr√©ation
        function showCreateModal() {
            document.getElementById('create-subsystem-modal').classList.add('active');
        }
        
        // Cacher le modal de cr√©ation
        function hideCreateModal() {
            document.getElementById('create-subsystem-modal').classList.remove('active');
            document.getElementById('create-subsystem-form').reset();
        }
        
        // Cr√©er un sous-syst√®me
        async function createSubsystem(e) {
            e.preventDefault();
            
            const subsystemData = {
                name: document.getElementById('subsystem-name').value.trim(),
                domain: document.getElementById('subsystem-domain').value.trim(),
                owner: document.getElementById('subsystem-owner').value.trim(),
                email: document.getElementById('subsystem-email').value.trim(),
                username: document.getElementById('subsystem-username').value.trim(),
                password: document.getElementById('subsystem-password').value,
                logo: document.getElementById('subsystem-logo').value.trim(),
                max_agents: parseInt(document.getElementById('max-agents').value) || 50,
                max_supervisors: parseInt(document.getElementById('max-supervisors').value) || 10,
                is_active: document.getElementById('subsystem-active').checked
            };
            
            // Validation
            if (!subsystemData.name || !subsystemData.domain || !subsystemData.owner || 
                !subsystemData.email || !subsystemData.username || !subsystemData.password) {
                alert('Veuillez remplir tous les champs obligatoires');
                return;
            }
            
            // R√©cup√©rer les jeux autoris√©s
            subsystemData.allowed_games = [];
            if (document.getElementById('game-borlette').checked) subsystemData.allowed_games.push('borlette');
            if (document.getElementById('game-boulpe').checked) subsystemData.allowed_games.push('boulpe');
            if (document.getElementById('game-lotto3').checked) subsystemData.allowed_games.push('lotto3');
            if (document.getElementById('game-lotto4').checked) subsystemData.allowed_games.push('lotto4');
            if (document.getElementById('game-lotto5').checked) subsystemData.allowed_games.push('lotto5');
            if (document.getElementById('game-grap').checked) subsystemData.allowed_games.push('grap');
            if (document.getElementById('game-marriage').checked) subsystemData.allowed_games.push('marriage');
            
            // R√©cup√©rer les multiplicateurs
            subsystemData.multipliers = {
                borlette: parseInt(document.getElementById('multiplier-borlette').value) || 60,
                boulpe: parseInt(document.getElementById('multiplier-boulpe').value) || 60,
                lotto3: parseInt(document.getElementById('multiplier-lotto3').value) || 500,
                lotto4: parseInt(document.getElementById('multiplier-lotto4').value) || 5000,
                lotto5: parseInt(document.getElementById('multiplier-lotto5').value) || 25000,
                grap: parseInt(document.getElementById('multiplier-grap').value) || 500,
                marriage: parseInt(document.getElementById('multiplier-marriage').value) || 1000
            };
            
            try {
                // Dans une version compl√®te, on enverrait √† l'API
                console.log('Cr√©ation sous-syst√®me:', subsystemData);
                
                // Simulation de cr√©ation r√©ussie
                alert(`‚úÖ Sous-syst√®me cr√©√© avec succ√®s !

üìã Informations d'acc√®s:
‚Ä¢ URL: https://${subsystemData.domain}.novalotto.com
‚Ä¢ Identifiant: ${subsystemData.username}
‚Ä¢ Mot de passe: ${subsystemData.password}
‚Ä¢ Email propri√©taire: ${subsystemData.email}

‚ö†Ô∏è Le propri√©taire devra changer le mot de passe √† la premi√®re connexion.`);
                
                hideCreateModal();
                
                // Recharger la liste
                loadSubsystems();
                loadDashboardData();
                
            } catch (error) {
                console.error('Erreur cr√©ation sous-syst√®me:', error);
                alert('Erreur lors de la cr√©ation du sous-syst√®me');
            }
        }
        
        // Voir un sous-syst√®me
        window.viewSubsystem = function(subsystemId) {
            alert(`Voir le sous-syst√®me ${subsystemId} - Fonctionnalit√© √† impl√©menter`);
        };
        
        // Modifier un sous-syst√®me
        window.editSubsystem = function(subsystemId) {
            alert(`Modifier le sous-syst√®me ${subsystemId} - Fonctionnalit√© √† impl√©menter`);
        };
        
        // Supprimer un sous-syst√®me
        window.deleteSubsystem = function(subsystemId) {
            if (confirm('√ätes-vous s√ªr de vouloir supprimer ce sous-syst√®me ?\n\nCette action supprimera √©galement tous les superviseurs et agents associ√©s.')) {
                alert(`Suppression du sous-syst√®me ${subsystemId} - Fonctionnalit√© √† impl√©menter`);
            }
        };
        
        // Rafra√Æchir le tableau de bord
        function refreshDashboard() {
            const btn = document.getElementById('refresh-dashboard');
            const originalHtml = btn.innerHTML;
            
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
            btn.disabled = true;
            
            loadDashboardData();
            
            setTimeout(() => {
                btn.innerHTML = originalHtml;
                btn.disabled = false;
                alert('Donn√©es rafra√Æchies');
            }, 1000);
        }
        
        // D√©connexion
        function logout() {
            if (confirm('√ätes-vous s√ªr de vouloir vous d√©connecter ?')) {
                localStorage.removeItem('nova_token');
                localStorage.removeItem('nova_user');
                window.location.href = '/index.html';
            }
        }
    </script>
</body>
</html>